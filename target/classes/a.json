[
  {
    "queryId": "20220802_072200_00194_gwi4x",
    "session": {
      "queryId": "20220802_072200_00194_gwi4x",
      "transactionId": "1f2861ea-0b98-4b82-ae6a-2040247b60cc",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659424920218,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_072200_00194_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T07:22:00.219Z",
      "endTime": "2022-08-02T07:22:00.585Z",
      "queuedTime": "30.84ms",
      "elapsedTime": "366.41ms",
      "executionTime": "335.55ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "14.88MB",
      "rawInputPositions": 21712,
      "cumulativeUserMemory": 1.319925383E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "1.91s",
      "totalScheduledTime": "2.02s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_085200_00254_gwi4x",
    "session": {
      "queryId": "20220802_085200_00254_gwi4x",
      "transactionId": "550d83f7-24d6-4515-97da-30618ccea8b9",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659430320498,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_085200_00254_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T08:52:00.499Z",
      "endTime": "2022-08-02T08:52:00.907Z",
      "queuedTime": "26.78ms",
      "elapsedTime": "408.96ms",
      "executionTime": "382.14ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "17.42MB",
      "rawInputPositions": 25443,
      "cumulativeUserMemory": 1.163373388E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.79s",
      "totalScheduledTime": "3.12s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_090131_00255_gwi4x",
    "session": {
      "queryId": "20220802_090131_00255_gwi4x",
      "transactionId": "7de0bf26-707b-429e-abf6-56f5c562ff8b",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659430891433,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_090131_00255_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_CAT = 'hive' AND TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE', 'VIEW')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T09:01:31.434Z",
      "endTime": "2022-08-02T09:01:33.151Z",
      "queuedTime": "796.13us",
      "elapsedTime": "1.72s",
      "executionTime": "1.72s",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "194.28kB",
      "rawInputPositions": 4107,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "83.00ms",
      "totalScheduledTime": "1.68s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_070922_00188_gwi4x",
    "session": {
      "queryId": "20220802_070922_00188_gwi4x",
      "transactionId": "534479b6-3564-438a-8f92-f13a154d2ef7",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659424162721,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_070922_00188_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T07:09:22.721Z",
      "endTime": "2022-08-02T07:09:23.571Z",
      "queuedTime": "691.75us",
      "elapsedTime": "850.04ms",
      "executionTime": "849.31ms",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "215.28kB",
      "rawInputPositions": 4792,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "57.00ms",
      "totalScheduledTime": "820.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_073701_00196_gwi4x",
    "session": {
      "queryId": "20220802_073701_00196_gwi4x",
      "transactionId": "9181a84e-96a3-43f7-bfe2-1aec97fbdc60",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659425821713,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_073701_00196_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T07:37:01.713Z",
      "endTime": "2022-08-02T07:37:03.517Z",
      "queuedTime": "168.50ms",
      "elapsedTime": "1.80s",
      "executionTime": "1.64s",
      "totalDrivers": 254,
      "queuedDrivers": 34,
      "runningDrivers": 0,
      "completedDrivers": 220,
      "rawInputDataSize": "15.28MB",
      "rawInputPositions": 22319,
      "cumulativeUserMemory": 7.749076321E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "823.99kB",
      "totalCpuTime": "2.94s",
      "totalScheduledTime": "5.06s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 86.61417322834646
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_072159_00193_gwi4x",
    "session": {
      "queryId": "20220802_072159_00193_gwi4x",
      "transactionId": "28003cb7-8a0b-4691-8a67-96d5c223a8fe",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659424919810,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_072159_00193_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T07:21:59.811Z",
      "endTime": "2022-08-02T07:22:00.180Z",
      "queuedTime": "27.19ms",
      "elapsedTime": "369.71ms",
      "executionTime": "342.49ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "14.88MB",
      "rawInputPositions": 21712,
      "cumulativeUserMemory": 1.392143769E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "1.94s",
      "totalScheduledTime": "2.56s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_070659_00185_gwi4x",
    "session": {
      "queryId": "20220802_070659_00185_gwi4x",
      "transactionId": "4eb6b619-d427-4a84-853e-aa4ca533fdf5",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659424019768,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_070659_00185_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T07:06:59.769Z",
      "endTime": "2022-08-02T07:07:00.143Z",
      "queuedTime": "27.83ms",
      "elapsedTime": "374.10ms",
      "executionTime": "346.23ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "14.45MB",
      "rawInputPositions": 21096,
      "cumulativeUserMemory": 1.798596511E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.21s",
      "totalScheduledTime": "2.68s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084218_00243_gwi4x",
    "session": {
      "queryId": "20220802_084218_00243_gwi4x",
      "transactionId": "8988b90f-f068-4f47-b1c4-f3369a78cac7",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429738070,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084218_00243_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_CAT = 'hive' AND TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE', 'VIEW')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T08:42:18.070Z",
      "endTime": "2022-08-02T08:42:19.663Z",
      "queuedTime": "526.54us",
      "elapsedTime": "1.59s",
      "executionTime": "1.59s",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "194.28kB",
      "rawInputPositions": 4107,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "1.70MB",
      "totalCpuTime": "70.00ms",
      "totalScheduledTime": "1.55s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_063805_00159_gwi4x",
    "session": {
      "queryId": "20220802_063805_00159_gwi4x",
      "transactionId": "de5273d0-789b-452c-9aa6-80c77824972b",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422285960,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FAILED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_063805_00159_gwi4x",
    "query": "select 1",
    "queryStats": {
      "createTime": "2022-08-02T06:38:05.961Z",
      "endTime": "2022-08-02T06:38:05.970Z",
      "queuedTime": "161.59us",
      "elapsedTime": "9.21ms",
      "executionTime": "9.02ms",
      "totalDrivers": 16,
      "queuedDrivers": 4,
      "runningDrivers": 9,
      "completedDrivers": 3,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "122B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "1.00ms",
      "totalScheduledTime": "1.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 18.75
    },
    "errorType": "USER_ERROR",
    "errorCode": {
      "code": 3,
      "name": "USER_CANCELED",
      "type": "USER_ERROR"
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084307_00244_gwi4x",
    "session": {
      "queryId": "20220802_084307_00244_gwi4x",
      "transactionId": "2c496603-4662-4fc2-98e6-0f6638a9e36c",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429787854,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084307_00244_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_CAT = 'hive' AND TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE', 'VIEW')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T08:43:07.854Z",
      "endTime": "2022-08-02T08:43:09.517Z",
      "queuedTime": "558.85us",
      "elapsedTime": "1.66s",
      "executionTime": "1.66s",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "194.28kB",
      "rawInputPositions": 4107,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "68.00ms",
      "totalScheduledTime": "1.63s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_063807_00160_gwi4x",
    "session": {
      "queryId": "20220802_063807_00160_gwi4x",
      "transactionId": "2361b552-75fc-464a-ac08-ddf0ce1f682e",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422287317,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_063807_00160_gwi4x",
    "query": "select t.continue_date as \"续费日期\",\nt.purchasenum,t.unittype,\ncount(distinct CASE\n                 WHEN student_type not in (9)  THEN t.student_id\n                 ELSE NULL\n             END) as \"续费总用户数\",\nsum(CASE\n                 WHEN student_type not in (9)  THEN t.payprice\n                 ELSE 0.00\n             END) as \"续费总金额\",\n           \ncount(distinct CASE\n                 WHEN student_type not in (2,9,11) THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费零售用户数(不包括学校和保险用户)\" ,\nsum(CASE\n                 WHEN student_type not in (2,9,11) THEN t.payprice\n                 ELSE 0.00\n             END) AS \"续费零售用户金额(不包括学校和保险用户)\" ,\n             count(distinct CASE\n                 WHEN student_type =2 THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费学校用户数\" ,\n             sum( CASE\n                 WHEN student_type =2 THEN t.payprice\n                 ELSE 0.00\n             END) AS \"续费学校用户金额\" \nfrom\n(\nselect date_format(date(substr(paymenttime,1,10)),'%Y-%m-%d') as continue_date, studentid as student_id,purchasenum,unittype,payprice\n      FROM ods_english_student.ods_fc_payment t\n      WHERE dt = '2021-11-11'\n    AND date_format(date(substr(paymenttime,1,10)),'%Y-%m-%d') between '2021-11-01' and '2021-11-11'\n        AND paywhat = '7'\n        ANd source = 1\n        AND paystatus=1\n        AND paymentType='1' \n        group by date_format(date(substr(paymenttime,1,10)),'%Y-%m-%d'), studentid,purchasenum,unittype,payprice\n ) t\nINNER JOIN\n  (SELECT student_id,student_type\n   FROM dwd.dwd_st_student_basic_info\n   WHERE dt ='2021-11-11'\n     AND extral_payment_time IS NOT NULL\n     and is_valid=1\n\tand student_name not like '%测试%' \n\tand student_name not like '%tpln%'\n\tand student_name not like '%Test%'\n     AND student_type not IN(9)\n ) b ON t.student_id=b.student_id\n group by t.continue_date,t.purchasenum,t.unittype\n order by t.continue_date asc\n",
    "queryStats": {
      "createTime": "2022-08-02T06:38:07.318Z",
      "endTime": "2022-08-02T06:38:08.693Z",
      "queuedTime": "31.99ms",
      "elapsedTime": "1.38s",
      "executionTime": "1.34s",
      "totalDrivers": 719,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 719,
      "rawInputDataSize": "49.01MB",
      "rawInputPositions": 2280734,
      "cumulativeUserMemory": 1.0722365782E10,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "11.86MB",
      "totalCpuTime": "9.89s",
      "totalScheduledTime": "12.23s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_063851_00164_gwi4x",
    "session": {
      "queryId": "20220802_063851_00164_gwi4x",
      "transactionId": "ad08b34e-fb73-4a58-ac22-222cc8fa7778",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422331618,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_063851_00164_gwi4x",
    "query": "select t.continue_date as \"续费日期\",\nt.purchasenum,t.unittype,\ncount(distinct CASE\n                 WHEN student_type not in (9)  THEN t.student_id\n                 ELSE NULL\n             END) as \"续费总用户数\",\nsum(CASE\n                 WHEN student_type not in (9)  THEN t.payprice\n                 ELSE 0.00\n             END) as \"续费总金额\",\n           \ncount(distinct CASE\n                 WHEN student_type not in (2,9,11) THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费零售用户数(不包括学校和保险用户)\" ,\nsum(CASE\n                 WHEN student_type not in (2,9,11) THEN t.payprice\n                 ELSE 0.00\n             END) AS \"续费零售用户金额(不包括学校和保险用户)\" ,\n             count(distinct CASE\n                 WHEN student_type =2 THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费学校用户数\" ,\n             sum( CASE\n                 WHEN student_type =2 THEN t.payprice\n                 ELSE 0.00\n             END) AS \"续费学校用户金额\" \nfrom\n(\nselect date_format(date(substr(paymenttime,1,10)),'%Y-%m-%d') as continue_date, studentid as student_id,purchasenum,unittype,payprice\n      FROM ods_english_student.ods_fc_payment t\n      WHERE dt = '2022-07-07'\n    AND date_format(date(substr(paymenttime,1,10)),'%Y-%m-%d') between '2022-07-01' and '2022-07-07'\n        AND paywhat = '7'\n        ANd source = 1\n        AND paystatus=1\n        AND paymentType='1' \n        group by date_format(date(substr(paymenttime,1,10)),'%Y-%m-%d'), studentid,purchasenum,unittype,payprice\n ) t\nINNER JOIN\n  (SELECT student_id,student_type\n   FROM dwd.dwd_st_student_basic_info\n   WHERE dt ='2022-07-07'\n     AND extral_payment_time IS NOT NULL\n     and is_valid=1\n\tand student_name not like '%测试%' \n\tand student_name not like '%tpln%'\n\tand student_name not like '%Test%'\n     AND student_type not IN(9)\n ) b ON t.student_id=b.student_id\n group by t.continue_date,t.purchasenum,t.unittype\n order by t.continue_date asc\n",
    "queryStats": {
      "createTime": "2022-08-02T06:38:51.619Z",
      "endTime": "2022-08-02T06:38:52.646Z",
      "queuedTime": "31.06ms",
      "elapsedTime": "1.03s",
      "executionTime": "996.06ms",
      "totalDrivers": 720,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 720,
      "rawInputDataSize": "56.67MB",
      "rawInputPositions": 2573936,
      "cumulativeUserMemory": 5.864199449E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "6.59MB",
      "totalCpuTime": "8.63s",
      "totalScheduledTime": "9.39s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083847_00235_gwi4x",
    "session": {
      "queryId": "20220802_083847_00235_gwi4x",
      "transactionId": "404c0fb7-9cf4-43fe-80af-7d649199f9b6",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429527196,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083847_00235_gwi4x",
    "query": "SELECT  \"日期\" ,  sum(\"pad端活跃人数\") AS \"sum(pad端活跃人数)\",sum(\"pad端4到12岁活跃人数\") AS \"sum(pad端4到12岁活跃人数)\",sum(\"风采秀家长伴读页活跃家长数\") AS \"sum(风采秀家长伴读页活跃家长数)\",sum(\"风采秀家长伴读页活跃4-12岁学生家长数\") AS \"sum(风采秀家长伴读页活跃4-12岁学生家长数)\" FROM (SELECT  \tread_day as \"日期\"    ,pad_active as \"pad端活跃人数\"    ,pad_4to12_active as \"pad端4到12岁活跃人数\"    ,parent_active as \"风采秀家长伴读页活跃家长数\"    ,parent_4to12_active as \"风采秀家长伴读页活跃4-12岁学生家长数\" from dwm.dwm_fcx_parent_active where dt = date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d')) T GROUP BY \"日期\" ORDER BY \"日期\" asc ",
    "queryStats": {
      "createTime": "2022-08-02T08:38:47.197Z",
      "endTime": "2022-08-02T08:38:47.304Z",
      "queuedTime": "16.57ms",
      "elapsedTime": "107.37ms",
      "executionTime": "90.77ms",
      "totalDrivers": 149,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 149,
      "rawInputDataSize": "4.91kB",
      "rawInputPositions": 519,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "42.00ms",
      "totalScheduledTime": "63.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_082200_00216_gwi4x",
    "session": {
      "queryId": "20220802_082200_00216_gwi4x",
      "transactionId": "bf930714-4d2a-4e24-98e9-f97b7caba862",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659428520398,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_082200_00216_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T08:22:00.399Z",
      "endTime": "2022-08-02T08:22:00.800Z",
      "queuedTime": "26.31ms",
      "elapsedTime": "401.94ms",
      "executionTime": "375.60ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "16.56MB",
      "rawInputPositions": 24178,
      "cumulativeUserMemory": 2.37528405E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.30s",
      "totalScheduledTime": "2.86s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_070700_00186_gwi4x",
    "session": {
      "queryId": "20220802_070700_00186_gwi4x",
      "transactionId": "33ff2100-fe6e-4e7e-9ea2-3fbd3c62056f",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659424020182,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_070700_00186_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T07:07:00.182Z",
      "endTime": "2022-08-02T07:07:00.566Z",
      "queuedTime": "28.84ms",
      "elapsedTime": "384.48ms",
      "executionTime": "355.61ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "14.45MB",
      "rawInputPositions": 21096,
      "cumulativeUserMemory": 2.02195156E8,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.22s",
      "totalScheduledTime": "2.64s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083621_00225_gwi4x",
    "session": {
      "queryId": "20220802_083621_00225_gwi4x",
      "transactionId": "a5406662-72b6-4894-816e-60b19f00e4d2",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429381928,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083621_00225_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_CAT = 'hive' AND TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE', 'VIEW')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T08:36:21.928Z",
      "endTime": "2022-08-02T08:36:23.474Z",
      "queuedTime": "523.61us",
      "elapsedTime": "1.55s",
      "executionTime": "1.55s",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "194.28kB",
      "rawInputPositions": 4107,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "67.00ms",
      "totalScheduledTime": "1.52s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083520_00217_gwi4x",
    "session": {
      "queryId": "20220802_083520_00217_gwi4x",
      "transactionId": "dce856bb-4abd-405b-981c-a146838d6d42",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429320827,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083520_00217_gwi4x",
    "query": "SELECT DISTINCT T.\"roam_agent_name\" FROM (select    * from hive.tmp.tmp_student_roam_result_new where dt >= date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d') and dt <= date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d')) T ORDER BY T.\"roam_agent_name\" ",
    "queryStats": {
      "createTime": "2022-08-02T08:35:20.827Z",
      "endTime": "2022-08-02T08:35:20.956Z",
      "queuedTime": "16.91ms",
      "elapsedTime": "129.86ms",
      "executionTime": "112.90ms",
      "totalDrivers": 149,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 149,
      "rawInputDataSize": "11.05kB",
      "rawInputPositions": 299,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "23.00ms",
      "totalScheduledTime": "48.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_064105_00174_gwi4x",
    "session": {
      "queryId": "20220802_064105_00174_gwi4x",
      "transactionId": "32a569af-cf91-470d-94a9-52b9aa03f25e",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422465682,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_064105_00174_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T06:41:05.682Z",
      "endTime": "2022-08-02T06:41:06.533Z",
      "queuedTime": "456.92us",
      "elapsedTime": "851.70ms",
      "executionTime": "851.21ms",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "215.28kB",
      "rawInputPositions": 4792,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "57.00ms",
      "totalScheduledTime": "821.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_073659_00195_gwi4x",
    "session": {
      "queryId": "20220802_073659_00195_gwi4x",
      "transactionId": "5c20e2f9-9b86-48b6-b7a7-a118d8425516",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659425819850,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_073659_00195_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T07:36:59.851Z",
      "endTime": "2022-08-02T07:37:01.671Z",
      "queuedTime": "268.20ms",
      "elapsedTime": "1.82s",
      "executionTime": "1.55s",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "15.28MB",
      "rawInputPositions": 22319,
      "cumulativeUserMemory": 2.92804792E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.99s",
      "totalScheduledTime": "4.52s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083601_00221_gwi4x",
    "session": {
      "queryId": "20220802_083601_00221_gwi4x",
      "transactionId": "9ba17673-0a29-45c7-8205-9a2766af3f87",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429361372,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083601_00221_gwi4x",
    "query": "SELECT  \"roam_agent_name\",\"student_id\",\"student_name\",\"last_valid_time\",\"student_age\",\"phone_number\",\"student_province\",\"student_city\",\"total_read_second\",\"etp_second_time\",\"book_readsecond_time\",\"video_readsecond_time\",\"eesecond_time\",\"exercise_readsecond_time\",\"playsecond_time\",\"readwordnum\",\"read_day\" FROM (select    * from hive.tmp.tmp_student_roam_result_new where dt >= date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d') and dt <= date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d')) T GROUP BY \"roam_agent_name\",\"student_id\",\"student_name\",\"last_valid_time\",\"student_age\",\"phone_number\",\"student_province\",\"student_city\",\"total_read_second\",\"etp_second_time\",\"book_readsecond_time\",\"video_readsecond_time\",\"eesecond_time\",\"exercise_readsecond_time\",\"playsecond_time\",\"readwordnum\",\"read_day\" ORDER BY \"read_day\" desc ",
    "queryStats": {
      "createTime": "2022-08-02T08:36:01.372Z",
      "endTime": "2022-08-02T08:36:01.474Z",
      "queuedTime": "15.86ms",
      "elapsedTime": "102.47ms",
      "executionTime": "86.59ms",
      "totalDrivers": 149,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 149,
      "rawInputDataSize": "11.05kB",
      "rawInputPositions": 299,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "41.00ms",
      "totalScheduledTime": "49.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083604_00224_gwi4x",
    "session": {
      "queryId": "20220802_083604_00224_gwi4x",
      "transactionId": "57301a58-0099-4ce5-80d3-50ec99d52cba",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429364821,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083604_00224_gwi4x",
    "query": "SELECT  \"roam_agent_name\",\"student_id\",\"student_name\",\"last_valid_time\",\"student_age\",\"phone_number\",\"student_province\",\"student_city\",\"total_read_second\",\"etp_second_time\",\"book_readsecond_time\",\"video_readsecond_time\",\"eesecond_time\",\"exercise_readsecond_time\",\"playsecond_time\",\"readwordnum\",\"read_day\" FROM (select    * from hive.tmp.tmp_student_roam_result_new where dt >= date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d') and dt <= date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d')) T GROUP BY \"roam_agent_name\",\"student_id\",\"student_name\",\"last_valid_time\",\"student_age\",\"phone_number\",\"student_province\",\"student_city\",\"total_read_second\",\"etp_second_time\",\"book_readsecond_time\",\"video_readsecond_time\",\"eesecond_time\",\"exercise_readsecond_time\",\"playsecond_time\",\"readwordnum\",\"read_day\" ORDER BY \"read_day\" desc ",
    "queryStats": {
      "createTime": "2022-08-02T08:36:04.821Z",
      "endTime": "2022-08-02T08:36:04.917Z",
      "queuedTime": "15.10ms",
      "elapsedTime": "96.05ms",
      "executionTime": "80.91ms",
      "totalDrivers": 149,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 149,
      "rawInputDataSize": "11.05kB",
      "rawInputPositions": 299,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "41.00ms",
      "totalScheduledTime": "70.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_063804_00158_gwi4x",
    "session": {
      "queryId": "20220802_063804_00158_gwi4x",
      "transactionId": "2a5f7388-8467-4e29-95e4-2f6dbab6b1b2",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422284546,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_063804_00158_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T06:38:04.546Z",
      "endTime": "2022-08-02T06:38:05.456Z",
      "queuedTime": "456.21us",
      "elapsedTime": "910.01ms",
      "executionTime": "909.52ms",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "215.28kB",
      "rawInputPositions": 4792,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "58.00ms",
      "totalScheduledTime": "875.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_063848_00161_gwi4x",
    "session": {
      "queryId": "20220802_063848_00161_gwi4x",
      "transactionId": "dd6bec14-4d2a-4178-88fe-5abd4a9c086b",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422328839,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FAILED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_063848_00161_gwi4x",
    "query": "select 1",
    "queryStats": {
      "createTime": "2022-08-02T06:38:48.839Z",
      "endTime": "2022-08-02T06:38:48.852Z",
      "queuedTime": "182.33us",
      "elapsedTime": "13.22ms",
      "executionTime": "13.00ms",
      "totalDrivers": 17,
      "queuedDrivers": 11,
      "runningDrivers": 6,
      "completedDrivers": 0,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "1.00ms",
      "totalScheduledTime": "7.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 0.0
    },
    "errorType": "USER_ERROR",
    "errorCode": {
      "code": 3,
      "name": "USER_CANCELED",
      "type": "USER_ERROR"
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_075600_00201_gwi4x",
    "session": {
      "queryId": "20220802_075600_00201_gwi4x",
      "transactionId": "ea074693-0203-4a00-842d-a1700e436da7",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659426960884,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_075600_00201_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt) dt,coalesce(t1.colName,t2.colName) colName,count1,count2 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and topic in ('point_wisdom_librarySearchZF_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1 full outer join ( select t1.dt,count(distinct t1.student_id) count2,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisual_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t2 on t1.dt = t2.dt and t1.colName = t2.colName ",
    "queryStats": {
      "createTime": "2022-08-02T07:56:00.885Z",
      "endTime": "2022-08-02T07:56:02.029Z",
      "queuedTime": "31.13ms",
      "elapsedTime": "1.14s",
      "executionTime": "1.11s",
      "totalDrivers": 625,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 625,
      "rawInputDataSize": "124.72MB",
      "rawInputPositions": 3125792,
      "cumulativeUserMemory": 2.0217932077E10,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "19.67MB",
      "totalCpuTime": "5.56s",
      "totalScheduledTime": "6.05s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084054_00240_gwi4x",
    "session": {
      "queryId": "20220802_084054_00240_gwi4x",
      "transactionId": "ddf78dc8-3a28-48f5-a8c2-009673a7177d",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429654056,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084054_00240_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_CAT = 'hive' AND TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE', 'VIEW')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T08:40:54.057Z",
      "endTime": "2022-08-02T08:40:55.642Z",
      "queuedTime": "623.31us",
      "elapsedTime": "1.59s",
      "executionTime": "1.58s",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "194.28kB",
      "rawInputPositions": 4107,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "71.00ms",
      "totalScheduledTime": "1.55s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084550_00250_gwi4x",
    "session": {
      "queryId": "20220802_084550_00250_gwi4x",
      "transactionId": "52685f58-628b-4395-b699-137c2775e73f",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429950727,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084550_00250_gwi4x",
    "query": "SELECT  \"日期\",\"累计付费有效大众用户总数\",\"有效学习超过30分钟大众用户数\",\"有效学习大众用户占比\",\"有效学习大众用户数\",\"英语有效大众用户数\",\"语文有效大众用户数\",\"英语有效学习超过30分钟大众用户数\",\"语文有效学习超过30分钟大众用户数\" FROM (select  create_time as \"日期\"\t  ,total_effective  as \"累计付费有效大众用户总数\"  ,over_total  as \"有效学习超过30分钟大众用户数\" ,round(effective_proportion,4) as \"有效学习大众用户占比\" ,all_total as \"有效学习大众用户数\" ,en_effective as \"英语有效大众用户数\" ,cn_effective as \"语文有效大众用户数\" ,en_over_total as \"英语有效学习超过30分钟大众用户数\" ,cn_over_total as \"语文有效学习超过30分钟大众用户数\" from hive.dwm.dwm_operate_kpi_entirety where dt=date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d') and create_time <= date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d') and create_time >= date_format(date_add( 'day' ,-7, current_timestamp),'%Y-%m-%d')) T GROUP BY \"日期\",\"累计付费有效大众用户总数\",\"有效学习超过30分钟大众用户数\",\"有效学习大众用户占比\",\"有效学习大众用户数\",\"英语有效大众用户数\",\"语文有效大众用户数\",\"英语有效学习超过30分钟大众用户数\",\"语文有效学习超过30分钟大众用户数\" ORDER BY \"日期\" desc ",
    "queryStats": {
      "createTime": "2022-08-02T08:45:50.728Z",
      "endTime": "2022-08-02T08:45:50.823Z",
      "queuedTime": "14.40ms",
      "elapsedTime": "95.59ms",
      "executionTime": "81.15ms",
      "totalDrivers": 149,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 149,
      "rawInputDataSize": "20.08kB",
      "rawInputPositions": 670,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "19.00ms",
      "totalScheduledTime": "35.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083818_00232_gwi4x",
    "session": {
      "queryId": "20220802_083818_00232_gwi4x",
      "transactionId": "4241b36c-f03f-4ba0-a86f-03b09d7a95fe",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429498608,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083818_00232_gwi4x",
    "query": "SELECT COUNT(*) FROM (SELECT \"日期\", \"ETP模块有效时长 秒\", \"视听模块有效时长 秒\", \"书籍模块有效时长 秒\", \"视频模块有效时长 秒\", \"真题模块有效时长 秒\", \"磨耳朵模块有效时长 秒\", \"文章模块有效时长 秒\", \"语文书籍模块有效时长 秒\", \"国学模块有效时长 秒\", \"电影模块有效时长 秒\", \"习题模块有效时长 秒\" FROM (SELECT dt AS \"日期\", etp AS \"ETP模块有效时长 秒\", st AS \"视听模块有效时长 秒\", book AS \"书籍模块有效时长 秒\", video AS \"视频模块有效时长 秒\", exer AS \"真题模块有效时长 秒\", film AS \"磨耳朵模块有效时长 秒\", cnarticle AS \"文章模块有效时长 秒\", cnbook AS \"语文书籍模块有效时长 秒\", cnguoxue AS \"国学模块有效时长 秒\", cnfilm AS \"电影模块有效时长 秒\", cnexer AS \"习题模块有效时长 秒\" FROM dwm.dwm_operate_kpi_moudle WHERE dt < date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d') AND dt >= date_format(date_add('day', -7, current_timestamp), '%Y-%m-%d')) T GROUP BY \"日期\", \"ETP模块有效时长 秒\", \"视听模块有效时长 秒\", \"书籍模块有效时长 秒\", \"视频模块有效时长 秒\", \"真题模块有效时长 秒\", \"磨耳朵模块有效时长 秒\", \"文章模块有效时长 秒\", \"语文书籍模块有效时长 秒\", \"国学模块有效时长 秒\", \"电影模块有效时长 秒\", \"习题模块有效时长 秒\") CT",
    "queryStats": {
      "createTime": "2022-08-02T08:38:18.609Z",
      "endTime": "2022-08-02T08:38:18.667Z",
      "queuedTime": "16.01ms",
      "elapsedTime": "58.18ms",
      "executionTime": "42.13ms",
      "totalDrivers": 18,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 18,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.00ms",
      "totalScheduledTime": "2.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_070222_00182_gwi4x",
    "session": {
      "queryId": "20220802_070222_00182_gwi4x",
      "transactionId": "6d4ff3dc-4a8b-45c2-bf60-6685d44e48ed",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659423742556,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_070222_00182_gwi4x",
    "query": "select t1.dt dt,count1 from  ( select t1.dt,count(distinct t1.student_id) count1 from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and topic in ('point_wisdom_librarySearchZF_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt ) t1",
    "queryStats": {
      "createTime": "2022-08-02T07:02:22.557Z",
      "endTime": "2022-08-02T07:02:22.920Z",
      "queuedTime": "31.84ms",
      "elapsedTime": "363.89ms",
      "executionTime": "332.00ms",
      "totalDrivers": 325,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 325,
      "rawInputDataSize": "6.93MB",
      "rawInputPositions": 1480751,
      "cumulativeUserMemory": 6.6348026E8,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "537.00ms",
      "totalScheduledTime": "625.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_081134_00213_gwi4x",
    "session": {
      "queryId": "20220802_081134_00213_gwi4x",
      "transactionId": "01c59d86-673b-46d3-a43c-28f096518f02",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659427894993,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_081134_00213_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt) dt,coalesce(t1.colName,t2.colName) colName,count1,count2 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendOver_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1 full outer join ( select t1.dt,count(t1.student_id) count2,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommend_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t2 on t1.dt = t2.dt and t1.colName = t2.colName ",
    "queryStats": {
      "createTime": "2022-08-02T08:11:34.994Z",
      "endTime": "2022-08-02T08:11:42.257Z",
      "queuedTime": "34.73ms",
      "elapsedTime": "7.26s",
      "executionTime": "7.23s",
      "totalDrivers": 797,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 797,
      "rawInputDataSize": "5.52GB",
      "rawInputPositions": 28364805,
      "cumulativeUserMemory": 2.647339431357E12,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "579.00MB",
      "totalCpuTime": "5.65m",
      "totalScheduledTime": "13.97m",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084545_00248_gwi4x",
    "session": {
      "queryId": "20220802_084545_00248_gwi4x",
      "transactionId": "5a670e39-e0b3-402b-8454-f13a60846832",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429945763,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084545_00248_gwi4x",
    "query": "SELECT  \"日期\" ,  sum(\"pad端活跃人数\") AS \"sum(pad端活跃人数)\",sum(\"pad端4到12岁活跃人数\") AS \"sum(pad端4到12岁活跃人数)\",sum(\"风采秀家长伴读页活跃家长数\") AS \"sum(风采秀家长伴读页活跃家长数)\",sum(\"风采秀家长伴读页活跃4-12岁学生家长数\") AS \"sum(风采秀家长伴读页活跃4-12岁学生家长数)\" FROM (SELECT  \tread_day as \"日期\"    ,pad_active as \"pad端活跃人数\"    ,pad_4to12_active as \"pad端4到12岁活跃人数\"    ,parent_active as \"风采秀家长伴读页活跃家长数\"    ,parent_4to12_active as \"风采秀家长伴读页活跃4-12岁学生家长数\" from dwm.dwm_fcx_parent_active where dt = date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d')) T GROUP BY \"日期\" ORDER BY \"日期\" asc ",
    "queryStats": {
      "createTime": "2022-08-02T08:45:45.763Z",
      "endTime": "2022-08-02T08:45:45.867Z",
      "queuedTime": "15.05ms",
      "elapsedTime": "104.69ms",
      "executionTime": "89.61ms",
      "totalDrivers": 149,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 149,
      "rawInputDataSize": "4.91kB",
      "rawInputPositions": 519,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "47.00ms",
      "totalScheduledTime": "86.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_080357_00203_gwi4x",
    "session": {
      "queryId": "20220802_080357_00203_gwi4x",
      "transactionId": "9ccd3193-91c2-412b-9eaf-9e5eba2a1eff",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659427437777,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_080357_00203_gwi4x",
    "query": "select t1.dt dt,t1.colName colName,count1 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisual_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1",
    "queryStats": {
      "createTime": "2022-08-02T08:03:57.778Z",
      "endTime": "2022-08-02T08:03:59.137Z",
      "queuedTime": "56.44ms",
      "elapsedTime": "1.36s",
      "executionTime": "1.30s",
      "totalDrivers": 313,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 313,
      "rawInputDataSize": "117.52MB",
      "rawInputPositions": 1645042,
      "cumulativeUserMemory": 2.1923867087E10,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "29.50MB",
      "totalCpuTime": "5.22s",
      "totalScheduledTime": "5.66s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_063945_00167_gwi4x",
    "session": {
      "queryId": "20220802_063945_00167_gwi4x",
      "transactionId": "c310c616-e4bf-4fbc-b9c2-2859576f3656",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422385499,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FAILED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_063945_00167_gwi4x",
    "query": "select 1",
    "queryStats": {
      "createTime": "2022-08-02T06:39:45.499Z",
      "endTime": "2022-08-02T06:39:45.510Z",
      "queuedTime": "166.23us",
      "elapsedTime": "11.85ms",
      "executionTime": "11.64ms",
      "totalDrivers": 15,
      "queuedDrivers": 8,
      "runningDrivers": 4,
      "completedDrivers": 3,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "298B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "1.00ms",
      "totalScheduledTime": "4.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 20.0
    },
    "errorType": "USER_ERROR",
    "errorCode": {
      "code": 3,
      "name": "USER_CANCELED",
      "type": "USER_ERROR"
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_075531_00200_gwi4x",
    "session": {
      "queryId": "20220802_075531_00200_gwi4x",
      "transactionId": "747b934a-f978-4239-af39-f16024fdcd68",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659426931659,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_075531_00200_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt) dt,coalesce(t1.colName,t2.colName) colName,count1,count2 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and topic in ('point_math_shopping_home_pv_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1 full outer join ( select t1.dt,count(distinct t1.student_id) count2,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisual_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t2 on t1.dt = t2.dt and t1.colName = t2.colName ",
    "queryStats": {
      "createTime": "2022-08-02T07:55:31.660Z",
      "endTime": "2022-08-02T07:55:32.904Z",
      "queuedTime": "30.29ms",
      "elapsedTime": "1.24s",
      "executionTime": "1.21s",
      "totalDrivers": 609,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 609,
      "rawInputDataSize": "124.73MB",
      "rawInputPositions": 3125792,
      "cumulativeUserMemory": 2.184373883E10,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "29.50MB",
      "totalCpuTime": "5.70s",
      "totalScheduledTime": "6.26s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083818_00233_gwi4x",
    "session": {
      "queryId": "20220802_083818_00233_gwi4x",
      "transactionId": "607bfe32-a939-4ff6-b3d6-4497ca89b512",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429498672,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083818_00233_gwi4x",
    "query": "SELECT  \"日期\",\"ETP模块有效时长 秒\",\"视听模块有效时长 秒\",\"书籍模块有效时长 秒\",\"视频模块有效时长 秒\",\"真题模块有效时长 秒\",\"磨耳朵模块有效时长 秒\",\"文章模块有效时长 秒\",\"语文书籍模块有效时长 秒\",\"国学模块有效时长 秒\",\"电影模块有效时长 秒\",\"习题模块有效时长 秒\" FROM (SELECT  \tdt as \"日期\"    ,etp as \"ETP模块有效时长 秒\"    ,st as \"视听模块有效时长 秒\"    ,book as \"书籍模块有效时长 秒\"    ,video as \"视频模块有效时长 秒\"    ,exer as \"真题模块有效时长 秒\"    ,film as \"磨耳朵模块有效时长 秒\"    ,cnarticle as \"文章模块有效时长 秒\"    ,cnbook as \"语文书籍模块有效时长 秒\"    ,cnguoxue as \"国学模块有效时长 秒\"    ,cnfilm as \"电影模块有效时长 秒\"    ,cnexer as \"习题模块有效时长 秒\" from dwm.dwm_operate_kpi_moudle where dt <date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d') and dt>=date_format(date_add( 'day' ,-7, current_timestamp),'%Y-%m-%d')) T GROUP BY \"日期\",\"ETP模块有效时长 秒\",\"视听模块有效时长 秒\",\"书籍模块有效时长 秒\",\"视频模块有效时长 秒\",\"真题模块有效时长 秒\",\"磨耳朵模块有效时长 秒\",\"文章模块有效时长 秒\",\"语文书籍模块有效时长 秒\",\"国学模块有效时长 秒\",\"电影模块有效时长 秒\",\"习题模块有效时长 秒\" ORDER BY \"日期\" desc ",
    "queryStats": {
      "createTime": "2022-08-02T08:38:18.673Z",
      "endTime": "2022-08-02T08:38:18.727Z",
      "queuedTime": "13.32ms",
      "elapsedTime": "54.80ms",
      "executionTime": "41.45ms",
      "totalDrivers": 69,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 69,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "5.00ms",
      "totalScheduledTime": "15.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_063804_00157_gwi4x",
    "session": {
      "queryId": "20220802_063804_00157_gwi4x",
      "transactionId": "56b1c757-3e48-4c7f-b91d-57ae7ce76811",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422284488,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FAILED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_063804_00157_gwi4x",
    "query": "select 1",
    "queryStats": {
      "createTime": "2022-08-02T06:38:04.488Z",
      "endTime": "2022-08-02T06:38:04.498Z",
      "queuedTime": "370.51us",
      "elapsedTime": "10.63ms",
      "executionTime": "10.22ms",
      "totalDrivers": 17,
      "queuedDrivers": 17,
      "runningDrivers": 0,
      "completedDrivers": 0,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "0.00ns",
      "totalScheduledTime": "0.00ns",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 0.0
    },
    "errorType": "USER_ERROR",
    "errorCode": {
      "code": 3,
      "name": "USER_CANCELED",
      "type": "USER_ERROR"
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084027_00239_gwi4x",
    "session": {
      "queryId": "20220802_084027_00239_gwi4x",
      "transactionId": "ed2134be-d2b4-48fa-8e0e-782c2043a844",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429627284,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084027_00239_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_CAT = 'hive' AND TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE', 'VIEW')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T08:40:27.284Z",
      "endTime": "2022-08-02T08:40:28.841Z",
      "queuedTime": "662.52us",
      "elapsedTime": "1.56s",
      "executionTime": "1.56s",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "194.28kB",
      "rawInputPositions": 4107,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "60.00ms",
      "totalScheduledTime": "1.53s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_063945_00168_gwi4x",
    "session": {
      "queryId": "20220802_063945_00168_gwi4x",
      "transactionId": "c2011dd0-cd34-46f3-bf4c-ed621601815f",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422385557,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_063945_00168_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T06:39:45.558Z",
      "endTime": "2022-08-02T06:39:46.416Z",
      "queuedTime": "429.58us",
      "elapsedTime": "858.56ms",
      "executionTime": "858.09ms",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "215.28kB",
      "rawInputPositions": 4792,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "56.00ms",
      "totalScheduledTime": "833.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083700_00226_gwi4x",
    "session": {
      "queryId": "20220802_083700_00226_gwi4x",
      "transactionId": "4691ad55-e466-4ff8-a36f-b5ed7efb5ca4",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429420005,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083700_00226_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T08:37:00.005Z",
      "endTime": "2022-08-02T08:37:00.406Z",
      "queuedTime": "31.17ms",
      "elapsedTime": "401.67ms",
      "executionTime": "370.47ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "16.96MB",
      "rawInputPositions": 24766,
      "cumulativeUserMemory": 2.039387427E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.28s",
      "totalScheduledTime": "2.56s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_070146_00181_gwi4x",
    "session": {
      "queryId": "20220802_070146_00181_gwi4x",
      "transactionId": "90d4d5a4-dd0b-495a-b3ee-0c9640b3bff0",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659423706814,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_070146_00181_gwi4x",
    "query": "select t1.dt dt,count1 from  ( select t1.dt,count(t1.student_id) count1 from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisualBack_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt ) t1",
    "queryStats": {
      "createTime": "2022-08-02T07:01:46.814Z",
      "endTime": "2022-08-02T07:01:49.667Z",
      "queuedTime": "31.16ms",
      "elapsedTime": "2.85s",
      "executionTime": "2.82s",
      "totalDrivers": 319,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 319,
      "rawInputDataSize": "80.14MB",
      "rawInputPositions": 10382571,
      "cumulativeUserMemory": 4.55897121403E11,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "201.63MB",
      "totalCpuTime": "15.06s",
      "totalScheduledTime": "17.30s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_071008_00190_gwi4x",
    "session": {
      "queryId": "20220802_071008_00190_gwi4x",
      "transactionId": "260e80a2-75a6-44e6-9aac-15a90995f5d0",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659424208255,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_071008_00190_gwi4x",
    "query": "select\nt.dt,\ncount(DISTINCT t.user_id)as keep_0,\ncount(DISTINCT case when date_add('day',1,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_1,\ncount(DISTINCT case when date_add('day',2,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_2,\ncount(DISTINCT case when date_add('day',3,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_3,\ncount(DISTINCT case when date_add('day',4,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_4,\ncount(DISTINCT case when date_add('day',5,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_5,\ncount(DISTINCT case when date_add('day',6,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_6,\ncount(DISTINCT case when date_add('day',7,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_7,\ncount(DISTINCT case when date_add('day',10,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_10,\ncount(DISTINCT case when date_add('day',14,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_14,\ncount(DISTINCT case when date_add('day',20,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_20,\ncount(DISTINCT case when date_add('day',30,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_30\nfrom \n(\n\tselect json_extract_scalar(source,'$.user_id') as user_id ,\n\tdt\n\tfrom\n\t(\n\t\tselect replace(t.source,'$','') as source ,dt\n\t\tfrom ods_point.all_point t \n\t\twhere dt>='2022-07-23'\n\t\tand dt<='2022-07-31'\n\t\tand t.topic in ('point_e_eng_book_tab_mc_topic')\n\t)t\nwhere json_extract_scalar(source,'$.user_id') <> ''\nand json_extract_scalar(source,'$.user_id') <> 'null'\nAND json_extract_scalar(source,'$.user_id')  IS NOT NULL\n\tgroup by json_extract_scalar(source,'$.user_id'),dt\n)t\ninner join\n(\n\tselect student_id\n\tfrom dwd.dwd_st_student_basic_info t\n\twhere dt=date_format(date_add( 'day',-1, current_timestamp),'%Y-%m-%d')\n\tand student_name not like '%test%'\n\tand student_name not like '%ceshi%'\n\tand student_name not like '%测试%'\n\tand student_name not like '%tpln%'\n) t1\non cast(t.user_id as bigint) =t1.student_id\n\nleft join \n(\n\tselect json_extract_scalar(source,'$.user_id') as user_id ,\n\tdt\n\tfrom\n\t(\n\t\tselect replace(t.source,'$','') as source ,dt\n\t\tfrom ods_point.all_point t \n\t\twhere \n\t\t\tcast(dt as date)>=date_add('day',1,cast('2022-07-23' as date))\n\t\tand cast(dt as date)<=date_add('day',7,cast('2022-07-31' as date))\n\t\tand t.topic in ('point_p_eng_book_tupianxunbao_test_pd_topic'\n,'point_p_eng_book_tupianxunbao_test_pv_topic'\n,'point_e_eng_book_peiyin_record_ubc_topic'\n,'point_e_eng_book_peiyin_rerecord_mc_topic'\n,'point_p_eng_book_peiyin_home_pass_mc_topic'\n,'point_p_eng_book_tupianxunbao_detail_pd_topic'\n,'point_e_eng_book_tupianxunbao_home_begin_mc_topic'\n,'point_e_eng_book_tupianxunbao_home_ubc_topic'\n,'point_p_eng_book_lingting_pause_pd_topic'\n,'point_e_eng_book_lingting_play_mc_topic'\n,'point_e_eng_book_peiyin_record_success_gold_mc_topic'\n,'point_p_eng_book_peiyin_home_pd_topic'\n,'point_e_eng_book_home_play_mc_topic'\n,'point_e_eng_book_lingting_like_mc_topic'\n,'point_e_eng_book_peiyin_like_mc_topic'\n,'point_e_eng_book_tab_mc_topic'\n,'point_p_eng_book_home_pv_topic'\n,'point_p_eng_book_peiyin_home_pv_topic'\n,'point_p_eng_book_peiyin_record_pd_topic'\n,'point_e_eng_book_peiyin_play_mc_topic'\n,'point_e_eng_book_peiyin_record_success_play_mc_topic'\n,'point_p_eng_book_lingting_home_pv_topic'\n,'point_p_eng_book_tupianxunbao_detail_pv_topic'\n,'point_e_eng_book_peiyin_record_success_save_mc_topic'\n,'point_e_eng_book_tupianxunbao_test_restart_mc_topic')\n\t)t\nwhere json_extract_scalar(source,'$.user_id') <> ''\nand json_extract_scalar(source,'$.user_id') <> 'null'\nAND json_extract_scalar(source,'$.user_id')  IS NOT NULL\n\tgroup by json_extract_scalar(source,'$.user_id'),dt\n)t2\non  cast(t.user_id as bigint)  = cast(t2.user_id as bigint)\ngroup by t.dt",
    "queryStats": {
      "createTime": "2022-08-02T07:10:08.258Z",
      "endTime": "2022-08-02T07:10:18.329Z",
      "queuedTime": "32.55ms",
      "elapsedTime": "10.07s",
      "executionTime": "10.04s",
      "totalDrivers": 3047,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 3047,
      "rawInputDataSize": "9.34GB",
      "rawInputPositions": 14799288,
      "cumulativeUserMemory": 2.69648135084E11,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "44.71MB",
      "totalCpuTime": "7.75m",
      "totalScheduledTime": "16.78m",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_063849_00162_gwi4x",
    "session": {
      "queryId": "20220802_063849_00162_gwi4x",
      "transactionId": "b5a5800a-0e11-4bd6-aea0-848377a8b5cc",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422329019,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_063849_00162_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T06:38:49.020Z",
      "endTime": "2022-08-02T06:38:49.881Z",
      "queuedTime": "454.37us",
      "elapsedTime": "861.32ms",
      "executionTime": "860.83ms",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "215.28kB",
      "rawInputPositions": 4792,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "58.00ms",
      "totalScheduledTime": "829.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_075514_00199_gwi4x",
    "session": {
      "queryId": "20220802_075514_00199_gwi4x",
      "transactionId": "e0379e00-542d-499e-8c8d-50e8b0fa3312",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659426914424,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_075514_00199_gwi4x",
    "query": "select t1.dt dt,t1.colName colName,count1 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and topic in ('point_math_shopping_home_pv_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1",
    "queryStats": {
      "createTime": "2022-08-02T07:55:14.425Z",
      "endTime": "2022-08-02T07:55:14.895Z",
      "queuedTime": "30.91ms",
      "elapsedTime": "470.59ms",
      "executionTime": "439.63ms",
      "totalDrivers": 309,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 309,
      "rawInputDataSize": "7.21MB",
      "rawInputPositions": 1480751,
      "cumulativeUserMemory": 8.63456247E8,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "768.00ms",
      "totalScheduledTime": "818.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083601_00220_gwi4x",
    "session": {
      "queryId": "20220802_083601_00220_gwi4x",
      "transactionId": "f46746e9-17a6-4994-b6c8-4c423d807191",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429361253,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083601_00220_gwi4x",
    "query": "SELECT COUNT(*) FROM (SELECT \"roam_agent_name\", \"student_id\", \"student_name\", \"last_valid_time\", \"student_age\", \"phone_number\", \"student_province\", \"student_city\", \"total_read_second\", \"etp_second_time\", \"book_readsecond_time\", \"video_readsecond_time\", \"eesecond_time\", \"exercise_readsecond_time\", \"playsecond_time\", \"readwordnum\", \"read_day\" FROM (SELECT * FROM hive.tmp.tmp_student_roam_result_new WHERE dt >= date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d') AND dt <= date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d')) T GROUP BY \"roam_agent_name\", \"student_id\", \"student_name\", \"last_valid_time\", \"student_age\", \"phone_number\", \"student_province\", \"student_city\", \"total_read_second\", \"etp_second_time\", \"book_readsecond_time\", \"video_readsecond_time\", \"eesecond_time\", \"exercise_readsecond_time\", \"playsecond_time\", \"readwordnum\", \"read_day\") CT",
    "queryStats": {
      "createTime": "2022-08-02T08:36:01.254Z",
      "endTime": "2022-08-02T08:36:01.366Z",
      "queuedTime": "20.04ms",
      "elapsedTime": "112.62ms",
      "executionTime": "92.53ms",
      "totalDrivers": 114,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 114,
      "rawInputDataSize": "11.05kB",
      "rawInputPositions": 299,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "34.00ms",
      "totalScheduledTime": "48.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_064123_00176_gwi4x",
    "session": {
      "queryId": "20220802_064123_00176_gwi4x",
      "transactionId": "8bc5042b-d335-46bd-bf78-ede0fa965689",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422483724,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_064123_00176_gwi4x",
    "query": "select t.continue_date as \"续费日期\",\nt.purchasenum,t.unittype,\ncount(distinct CASE\n                 WHEN student_type not in (9)  THEN t.student_id\n                 ELSE NULL\n             END) as \"续费总用户数\",\nsum(CASE\n                 WHEN student_type not in (9)  THEN t.payprice\n                 ELSE 0.00\n             END) as \"续费总金额\",\n           \ncount(distinct CASE\n                 WHEN student_type not in (2,9,11) THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费零售用户数(不包括学校和保险用户)\" ,\nsum(CASE\n                 WHEN student_type not in (2,9,11) THEN t.payprice\n                 ELSE 0.00\n             END) AS \"续费零售用户金额(不包括学校和保险用户)\" ,\n             count(distinct CASE\n                 WHEN student_type =2 THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费学校用户数\" ,\n             sum( CASE\n                 WHEN student_type =2 THEN t.payprice\n                 ELSE 0.00\n             END) AS \"续费学校用户金额\" \nfrom\n(\nselect date_format(date(substr(paymenttime,1,10)),'%Y-%m-%d') as continue_date, studentid as student_id,purchasenum,unittype,payprice\n      FROM ods_english_student.ods_fc_payment t\n      WHERE dt = '2021-11-11'\n    AND date_format(date(substr(paymenttime,1,10)),'%Y-%m-%d') between '2021-11-01' and '2021-11-11'\n        AND paywhat = '7'\n        ANd source = 1\n        AND paystatus=1\n        AND paymentType='1' \n        group by date_format(date(substr(paymenttime,1,10)),'%Y-%m-%d'), studentid,purchasenum,unittype,payprice\n ) t\nINNER JOIN\n  (SELECT student_id,student_type\n   FROM dwd.dwd_st_student_basic_info\n   WHERE dt ='2021-11-11'\n     AND extral_payment_time IS NOT NULL\n     and is_valid=1\n\tand student_name not like '%测试%' \n\tand student_name not like '%tpln%'\n\tand student_name not like '%Test%'\n\tand student_name not like '%test%'\n\tand student_name not like '%ceshi%'\n     AND student_type not IN(9)\n ) b ON t.student_id=b.student_id\n group by t.continue_date,t.purchasenum,t.unittype\n order by t.continue_date asc\n",
    "queryStats": {
      "createTime": "2022-08-02T06:41:23.725Z",
      "endTime": "2022-08-02T06:41:25.084Z",
      "queuedTime": "31.20ms",
      "elapsedTime": "1.36s",
      "executionTime": "1.33s",
      "totalDrivers": 719,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 719,
      "rawInputDataSize": "49.01MB",
      "rawInputPositions": 2280734,
      "cumulativeUserMemory": 7.558352333E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "8.09MB",
      "totalCpuTime": "8.07s",
      "totalScheduledTime": "8.76s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_080903_00209_gwi4x",
    "session": {
      "queryId": "20220802_080903_00209_gwi4x",
      "transactionId": "ff71177e-4fcb-428f-b3f3-15989b815c2b",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659427743997,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_080903_00209_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt) dt,coalesce(t1.colName,t2.colName) colName,count1,count2 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommend_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1 full outer join ( select t1.dt,count(distinct t1.student_id) count2,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisualContinuePlaying_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t2 on t1.dt = t2.dt and t1.colName = t2.colName ",
    "queryStats": {
      "createTime": "2022-08-02T08:09:03.998Z",
      "endTime": "2022-08-02T08:09:07.425Z",
      "queuedTime": "31.63ms",
      "elapsedTime": "3.43s",
      "executionTime": "3.40s",
      "totalDrivers": 754,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 754,
      "rawInputDataSize": "2.02GB",
      "rawInputPositions": 23544021,
      "cumulativeUserMemory": 1.067420694832E12,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "517.49MB",
      "totalCpuTime": "2.22m",
      "totalScheduledTime": "3.11m",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_075200_00198_gwi4x",
    "session": {
      "queryId": "20220802_075200_00198_gwi4x",
      "transactionId": "5ad7e9b1-d6de-4bd7-913e-66bac8fb0755",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659426720311,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_075200_00198_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T07:52:00.311Z",
      "endTime": "2022-08-02T07:52:00.689Z",
      "queuedTime": "31.10ms",
      "elapsedTime": "378.90ms",
      "executionTime": "347.76ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "15.74MB",
      "rawInputPositions": 22993,
      "cumulativeUserMemory": 2.408026747E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.23s",
      "totalScheduledTime": "2.81s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_065200_00179_gwi4x",
    "session": {
      "queryId": "20220802_065200_00179_gwi4x",
      "transactionId": "928a5209-ad9b-4df0-9d81-37a0d285796d",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659423120148,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_065200_00179_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T06:52:00.149Z",
      "endTime": "2022-08-02T06:52:00.498Z",
      "queuedTime": "27.11ms",
      "elapsedTime": "349.10ms",
      "executionTime": "321.97ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "13.99MB",
      "rawInputPositions": 20437,
      "cumulativeUserMemory": 6.85105922E8,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "1.96s",
      "totalScheduledTime": "2.14s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_081040_00212_gwi4x",
    "session": {
      "queryId": "20220802_081040_00212_gwi4x",
      "transactionId": "e24e5560-d07d-4777-b26c-a8ce333a47a8",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659427840212,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_081040_00212_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt) dt,coalesce(t1.colName,t2.colName) colName,count1,count2 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendOver_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1 full outer join ( select t1.dt,count(t1.student_id) count2,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendShow_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t2 on t1.dt = t2.dt and t1.colName = t2.colName ",
    "queryStats": {
      "createTime": "2022-08-02T08:10:40.213Z",
      "endTime": "2022-08-02T08:10:45.039Z",
      "queuedTime": "35.88ms",
      "elapsedTime": "4.83s",
      "executionTime": "4.79s",
      "totalDrivers": 755,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 755,
      "rawInputDataSize": "3.60GB",
      "rawInputPositions": 25496170,
      "cumulativeUserMemory": 1.234095248139E12,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "443.35MB",
      "totalCpuTime": "3.69m",
      "totalScheduledTime": "7.39m",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084503_00247_gwi4x",
    "session": {
      "queryId": "20220802_084503_00247_gwi4x",
      "transactionId": "5f5847a8-7211-46a4-abca-7088664af032",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429903780,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084503_00247_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_CAT = 'hive' AND TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE', 'VIEW')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T08:45:03.781Z",
      "endTime": "2022-08-02T08:45:05.542Z",
      "queuedTime": "504.65us",
      "elapsedTime": "1.76s",
      "executionTime": "1.76s",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "194.28kB",
      "rawInputPositions": 4107,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "66.00ms",
      "totalScheduledTime": "1.73s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_080659_00206_gwi4x",
    "session": {
      "queryId": "20220802_080659_00206_gwi4x",
      "transactionId": "e30b900b-7c03-4308-be25-99acbbc771e7",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659427619927,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_080659_00206_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T08:06:59.927Z",
      "endTime": "2022-08-02T08:07:00.331Z",
      "queuedTime": "29.16ms",
      "elapsedTime": "404.07ms",
      "executionTime": "374.87ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "16.12MB",
      "rawInputPositions": 23544,
      "cumulativeUserMemory": 1.512563531E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.19s",
      "totalScheduledTime": "2.64s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_063900_00166_gwi4x",
    "session": {
      "queryId": "20220802_063900_00166_gwi4x",
      "transactionId": "d5c64c4c-26fd-4a90-a535-29f6edb8fa1a",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422340638,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_063900_00166_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T06:39:00.639Z",
      "endTime": "2022-08-02T06:39:01.760Z",
      "queuedTime": "450.76us",
      "elapsedTime": "1.12s",
      "executionTime": "1.12s",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "215.28kB",
      "rawInputPositions": 4792,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "68.00ms",
      "totalScheduledTime": "1.09s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_064028_00170_gwi4x",
    "session": {
      "queryId": "20220802_064028_00170_gwi4x",
      "transactionId": "ae285a55-024b-48db-84dc-afe097ed004b",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422428832,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_064028_00170_gwi4x",
    "query": "select t.continue_date as \"续费日期\",\ncount(distinct CASE\n                 WHEN student_type not in (9) THEN t.student_id\n                 ELSE NULL\n             END) as \"续费总用户数\",\ncount(distinct CASE\n                 WHEN student_type not in (2,9,11) THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费零售用户数(不包括学校和保险用户)\" ,\ncount(distinct CASE\n                 WHEN student_type =1 THEN t.student_id\n                 ELSE NULL\n             END)  AS \"续费大众用户数\" ,\n       count(distinct CASE\n                 WHEN student_type =2 THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费学校用户数\" ,\n       count(distinct CASE\n                 WHEN student_type = 3 THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费订货奖励用户数\" ,\n       count(distinct CASE\n                 WHEN student_type = 4 THEN t.student_id\n                 ELSE NULL\n             END)  AS \"续费实体店补贴用户数\" ,\n       count(distinct CASE\n                 WHEN student_type = 5 THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费办公室租赁补贴用户数\"  ,\n       count(distinct CASE\n                 WHEN student_type = 6 THEN t.student_id\n                 ELSE NULL\n             END)  AS \"续费商务赠送用户数\",\n       count(distinct CASE\n                 WHEN student_type = 7 THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费内部员工购买用户数\" ,\n       count(distinct CASE\n                 WHEN student_type =8 THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费内部员工使用用户数\" ,\n       count(distinct CASE\n                 WHEN student_type = 10 THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费三会补贴用户数\",\n       count(distinct CASE\n                 WHEN student_type = 11 THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费保险账号用户数\" ,\n       count(distinct CASE\n                 WHEN student_type = 14 THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费试用转正式用户数\",\n       count(distinct CASE\n                 WHEN student_type = 15 THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费代理商自开用户数\" ,\n       count(distinct CASE\n                 WHEN student_type = 16 THEN t.student_id\n                 ELSE NULL\n             END) AS \"续费ETP转正式用户数\"\nfrom\n(\nselect date_format(date(substr(paymenttime,1,10)),'%Y-%m-%d') as continue_date,    studentid as student_id\n      FROM ods_english_student.ods_fc_payment t\n      WHERE dt = '2022-07-07'\n    AND date_format(date(substr(paymenttime,1,10)),'%Y-%m-%d') between '2022-07-01' and '2022-07-07'\n        AND paywhat = '7'\n        ANd source = 1\n        AND paystatus=1\n        AND paymentType='1' \n        group by date_format(date(substr(paymenttime,1,10)),'%Y-%m-%d'),studentid\n ) t\nINNER JOIN\n  (SELECT student_id,student_type\n   FROM dwd.dwd_st_student_basic_info\n   WHERE dt ='2022-07-07'\n     AND extral_payment_time IS NOT NULL\n     and is_valid=1\n\tand student_name not like '%测试%' \n\tand student_name not like '%tpln%'\n\tand student_name not like '%Test%'\n\tand student_name not like '%test%'\n\tand student_name not like '%ceshi%'\n     AND student_type not IN(9)\n ) b ON t.student_id=b.student_id\n group by t.continue_date\n order by t.continue_date asc\n\n\n ",
    "queryStats": {
      "createTime": "2022-08-02T06:40:28.833Z",
      "endTime": "2022-08-02T06:40:30.055Z",
      "queuedTime": "37.47ms",
      "elapsedTime": "1.22s",
      "executionTime": "1.19s",
      "totalDrivers": 1872,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 1872,
      "rawInputDataSize": "56.66MB",
      "rawInputPositions": 2573936,
      "cumulativeUserMemory": 6.745027113E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "10.36MB",
      "totalCpuTime": "8.58s",
      "totalScheduledTime": "9.70s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_070222_00183_gwi4x",
    "session": {
      "queryId": "20220802_070222_00183_gwi4x",
      "transactionId": "1d03314c-11fe-4aa6-814a-e8d3a8bbf5ec",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659423742734,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_070222_00183_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt) dt,count1,count2 from  ( select t1.dt,count(t1.student_id) count1 from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisualBack_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt ) t1 full outer join ( select t1.dt,count(t1.student_id) count2 from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_wisdom_librarySearchZF_topic','point_wisdom_librarySearch_topic','point_chineseHistoryLibrary_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt ) t2 on t1.dt = t2.dt ",
    "queryStats": {
      "createTime": "2022-08-02T07:02:22.736Z",
      "endTime": "2022-08-02T07:02:28.203Z",
      "queuedTime": "31.17ms",
      "elapsedTime": "5.47s",
      "executionTime": "5.44s",
      "totalDrivers": 660,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 660,
      "rawInputDataSize": "142.27MB",
      "rawInputPositions": 20739428,
      "cumulativeUserMemory": 9.46918027713E11,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "409.89MB",
      "totalCpuTime": "24.22s",
      "totalScheduledTime": "30.12s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_080700_00207_gwi4x",
    "session": {
      "queryId": "20220802_080700_00207_gwi4x",
      "transactionId": "448205a5-ab3f-4145-9cc4-68d8781a672a",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659427620371,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_080700_00207_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T08:07:00.371Z",
      "endTime": "2022-08-02T08:07:00.746Z",
      "queuedTime": "27.16ms",
      "elapsedTime": "375.69ms",
      "executionTime": "348.48ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "16.10MB",
      "rawInputPositions": 23544,
      "cumulativeUserMemory": 1.955522217E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.23s",
      "totalScheduledTime": "2.55s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_064105_00173_gwi4x",
    "session": {
      "queryId": "20220802_064105_00173_gwi4x",
      "transactionId": "ad0ce429-88d8-43e9-ba25-d455dfeb5543",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422465440,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FAILED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_064105_00173_gwi4x",
    "query": "select 1",
    "queryStats": {
      "createTime": "2022-08-02T06:41:05.440Z",
      "endTime": "2022-08-02T06:41:05.449Z",
      "queuedTime": "161.66us",
      "elapsedTime": "9.51ms",
      "executionTime": "9.31ms",
      "totalDrivers": 17,
      "queuedDrivers": 12,
      "runningDrivers": 5,
      "completedDrivers": 0,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "474B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "0.00ns",
      "totalScheduledTime": "0.00ns",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 0.0
    },
    "errorType": "USER_ERROR",
    "errorCode": {
      "code": 3,
      "name": "USER_CANCELED",
      "type": "USER_ERROR"
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084430_00246_gwi4x",
    "session": {
      "queryId": "20220802_084430_00246_gwi4x",
      "transactionId": "6f8b611d-120c-4c7f-ab39-1d53a9e19006",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429870916,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084430_00246_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_CAT = 'hive' AND TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE', 'VIEW')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T08:44:30.916Z",
      "endTime": "2022-08-02T08:44:32.673Z",
      "queuedTime": "538.78us",
      "elapsedTime": "1.76s",
      "executionTime": "1.76s",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "194.28kB",
      "rawInputPositions": 4107,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "67.00ms",
      "totalScheduledTime": "1.73s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083520_00218_gwi4x",
    "session": {
      "queryId": "20220802_083520_00218_gwi4x",
      "transactionId": "94d660bf-eca5-4f07-8ec1-d25902843cc8",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429320897,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083520_00218_gwi4x",
    "query": "SELECT COUNT(*) FROM (SELECT \"roam_agent_name\", \"student_id\", \"student_name\", \"last_valid_time\", \"student_age\", \"phone_number\", \"student_province\", \"student_city\", \"total_read_second\", \"etp_second_time\", \"book_readsecond_time\", \"video_readsecond_time\", \"eesecond_time\", \"exercise_readsecond_time\", \"playsecond_time\", \"readwordnum\", \"read_day\" FROM (SELECT * FROM hive.tmp.tmp_student_roam_result_new WHERE dt >= date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d') AND dt <= date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d')) T GROUP BY \"roam_agent_name\", \"student_id\", \"student_name\", \"last_valid_time\", \"student_age\", \"phone_number\", \"student_province\", \"student_city\", \"total_read_second\", \"etp_second_time\", \"book_readsecond_time\", \"video_readsecond_time\", \"eesecond_time\", \"exercise_readsecond_time\", \"playsecond_time\", \"readwordnum\", \"read_day\") CT",
    "queryStats": {
      "createTime": "2022-08-02T08:35:20.897Z",
      "endTime": "2022-08-02T08:35:21.034Z",
      "queuedTime": "16.28ms",
      "elapsedTime": "137.25ms",
      "executionTime": "120.94ms",
      "totalDrivers": 114,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 114,
      "rawInputDataSize": "11.05kB",
      "rawInputPositions": 299,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "55.00ms",
      "totalScheduledTime": "152.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_064045_00171_gwi4x",
    "session": {
      "queryId": "20220802_064045_00171_gwi4x",
      "transactionId": "a1d0bcf6-2acd-4184-8617-fdc3d44ee228",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422445525,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FAILED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_064045_00171_gwi4x",
    "query": "select 1",
    "queryStats": {
      "createTime": "2022-08-02T06:40:45.525Z",
      "endTime": "2022-08-02T06:40:45.536Z",
      "queuedTime": "165.41us",
      "elapsedTime": "11.42ms",
      "executionTime": "11.23ms",
      "totalDrivers": 17,
      "queuedDrivers": 11,
      "runningDrivers": 6,
      "completedDrivers": 0,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "352B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "0.00ns",
      "totalScheduledTime": "4.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 0.0
    },
    "errorType": "USER_ERROR",
    "errorCode": {
      "code": 3,
      "name": "USER_CANCELED",
      "type": "USER_ERROR"
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084150_00242_gwi4x",
    "session": {
      "queryId": "20220802_084150_00242_gwi4x",
      "transactionId": "950ee618-1809-42ed-b5f6-5dd401b6c14c",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429710839,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084150_00242_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_CAT = 'hive' AND TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE', 'VIEW')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T08:41:50.840Z",
      "endTime": "2022-08-02T08:41:52.518Z",
      "queuedTime": "512.79us",
      "elapsedTime": "1.68s",
      "executionTime": "1.68s",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "194.28kB",
      "rawInputPositions": 4107,
      "cumulativeUserMemory": 1.87560779E8,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "67.00ms",
      "totalScheduledTime": "1.64s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_080924_00210_gwi4x",
    "session": {
      "queryId": "20220802_080924_00210_gwi4x",
      "transactionId": "05547161-9504-4926-88f2-8894cb01ae96",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659427764767,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_080924_00210_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt) dt,coalesce(t1.colName,t2.colName) colName,count1,count2 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommend_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1 full outer join ( select t1.dt,count(t1.student_id) count2,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisualContinuePlaying_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t2 on t1.dt = t2.dt and t1.colName = t2.colName ",
    "queryStats": {
      "createTime": "2022-08-02T08:09:24.768Z",
      "endTime": "2022-08-02T08:09:28.387Z",
      "queuedTime": "30.03ms",
      "elapsedTime": "3.62s",
      "executionTime": "3.59s",
      "totalDrivers": 706,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 706,
      "rawInputDataSize": "2.02GB",
      "rawInputPositions": 23544021,
      "cumulativeUserMemory": 1.193012436172E12,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "468.19MB",
      "totalCpuTime": "2.17m",
      "totalScheduledTime": "2.96m",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_071025_00192_gwi4x",
    "session": {
      "queryId": "20220802_071025_00192_gwi4x",
      "transactionId": "9ed1ba22-d260-42cc-a467-5c727d47aa23",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659424225326,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_071025_00192_gwi4x",
    "query": "select\nt.dt,\ncount(DISTINCT t.user_id)as keep_0,\ncount(DISTINCT case when date_add('day',1,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_1,\ncount(DISTINCT case when date_add('day',2,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_2,\ncount(DISTINCT case when date_add('day',3,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_3,\ncount(DISTINCT case when date_add('day',4,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_4,\ncount(DISTINCT case when date_add('day',5,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_5,\ncount(DISTINCT case when date_add('day',6,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_6,\ncount(DISTINCT case when date_add('day',7,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_7,\ncount(DISTINCT case when date_add('day',10,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_10,\ncount(DISTINCT case when date_add('day',14,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_14,\ncount(DISTINCT case when date_add('day',20,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_20,\ncount(DISTINCT case when date_add('day',30,cast(t.dt as date))=cast(t2.dt as date) then t.user_id else null end  ) as keep_30\nfrom \n(\n\tselect json_extract_scalar(source,'$.user_id') as user_id ,\n\tdt\n\tfrom\n\t(\n\t\tselect replace(t.source,'$','') as source ,dt\n\t\tfrom ods_point.all_point t \n\t\twhere dt>='2022-07-23'\n\t\tand dt<='2022-07-31'\n\t\tand t.topic in ('point_e_eng_book_tab_mc_topic')\n\t)t\nwhere json_extract_scalar(source,'$.user_id') <> ''\nand json_extract_scalar(source,'$.user_id') <> 'null'\nAND json_extract_scalar(source,'$.user_id')  IS NOT NULL\n\tgroup by json_extract_scalar(source,'$.user_id'),dt\n)t\ninner join\n(\n\tselect student_id\n\tfrom dwd.dwd_st_student_basic_info t\n\twhere dt=date_format(date_add( 'day',-1, current_timestamp),'%Y-%m-%d')\n\tand student_name not like '%test%'\n\tand student_name not like '%ceshi%'\n\tand student_name not like '%测试%'\n\tand student_name not like '%tpln%'\n) t1\non cast(t.user_id as bigint) =t1.student_id\n\nleft join \n(\n\tselect json_extract_scalar(source,'$.user_id') as user_id ,\n\tdt\n\tfrom\n\t(\n\t\tselect replace(t.source,'$','') as source ,dt\n\t\tfrom ods_point.all_point t \n\t\twhere \n\t\t\tcast(dt as date)>=date_add('day',1,cast('2022-07-23' as date))\n\t\tand cast(dt as date)<=date_add('day',7,cast('2022-07-31' as date))\n\t\tand t.topic in ('point_p_eng_book_tupianxunbao_test_pd_topic'\n,'point_p_eng_book_tupianxunbao_test_pv_topic'\n,'point_e_eng_book_peiyin_record_ubc_topic'\n,'point_e_eng_book_peiyin_rerecord_mc_topic'\n,'point_p_eng_book_peiyin_home_pass_mc_topic'\n,'point_p_eng_book_tupianxunbao_detail_pd_topic'\n,'point_e_eng_book_tupianxunbao_home_begin_mc_topic'\n,'point_e_eng_book_tupianxunbao_home_ubc_topic'\n,'point_p_eng_book_lingting_pause_pd_topic'\n,'point_e_eng_book_lingting_play_mc_topic'\n,'point_e_eng_book_peiyin_record_success_gold_mc_topic'\n,'point_p_eng_book_peiyin_home_pd_topic'\n,'point_e_eng_book_home_play_mc_topic'\n,'point_e_eng_book_lingting_like_mc_topic'\n,'point_e_eng_book_peiyin_like_mc_topic'\n,'point_e_eng_book_tab_mc_topic'\n,'point_p_eng_book_home_pv_topic'\n,'point_p_eng_book_peiyin_home_pv_topic'\n,'point_p_eng_book_peiyin_record_pd_topic'\n,'point_e_eng_book_peiyin_play_mc_topic'\n,'point_e_eng_book_peiyin_record_success_play_mc_topic'\n,'point_p_eng_book_lingting_home_pv_topic'\n,'point_p_eng_book_tupianxunbao_detail_pv_topic'\n,'point_e_eng_book_peiyin_record_success_save_mc_topic'\n,'point_e_eng_book_tupianxunbao_test_restart_mc_topic')\n\t)t\nwhere json_extract_scalar(source,'$.user_id') <> ''\nand json_extract_scalar(source,'$.user_id') <> 'null'\nAND json_extract_scalar(source,'$.user_id')  IS NOT NULL\n\tgroup by json_extract_scalar(source,'$.user_id'),dt\n)t2\non  cast(t.user_id as bigint)  = cast(t2.user_id as bigint)\ngroup by t.dt",
    "queryStats": {
      "createTime": "2022-08-02T07:10:25.328Z",
      "endTime": "2022-08-02T07:10:36.023Z",
      "queuedTime": "34.81ms",
      "elapsedTime": "10.70s",
      "executionTime": "10.66s",
      "totalDrivers": 3047,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 3047,
      "rawInputDataSize": "9.34GB",
      "rawInputPositions": 14799288,
      "cumulativeUserMemory": 2.97066517889E11,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "45.81MB",
      "totalCpuTime": "7.78m",
      "totalScheduledTime": "18.29m",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_085200_00253_gwi4x",
    "session": {
      "queryId": "20220802_085200_00253_gwi4x",
      "transactionId": "237a4d5e-3704-4763-af70-901d3deedcf5",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659430320044,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_085200_00253_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T08:52:00.045Z",
      "endTime": "2022-08-02T08:52:00.459Z",
      "queuedTime": "27.03ms",
      "elapsedTime": "414.91ms",
      "executionTime": "387.85ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "17.41MB",
      "rawInputPositions": 25443,
      "cumulativeUserMemory": 1.825010802E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "3.47s",
      "totalScheduledTime": "4.09s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084550_00249_gwi4x",
    "session": {
      "queryId": "20220802_084550_00249_gwi4x",
      "transactionId": "0a38fe09-3bae-4357-bc16-536af4972374",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429950147,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084550_00249_gwi4x",
    "query": "SELECT COUNT(*) FROM (SELECT \"日期\", \"累计付费有效大众用户总数\", \"有效学习超过30分钟大众用户数\", \"有效学习大众用户占比\", \"有效学习大众用户数\", \"英语有效大众用户数\", \"语文有效大众用户数\", \"英语有效学习超过30分钟大众用户数\", \"语文有效学习超过30分钟大众用户数\" FROM (SELECT create_time AS \"日期\", total_effective AS \"累计付费有效大众用户总数\", over_total AS \"有效学习超过30分钟大众用户数\", round(effective_proportion, 4) AS \"有效学习大众用户占比\", all_total AS \"有效学习大众用户数\", en_effective AS \"英语有效大众用户数\", cn_effective AS \"语文有效大众用户数\", en_over_total AS \"英语有效学习超过30分钟大众用户数\", cn_over_total AS \"语文有效学习超过30分钟大众用户数\" FROM hive.dwm.dwm_operate_kpi_entirety WHERE dt = date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d') AND create_time <= date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d') AND create_time >= date_format(date_add('day', -7, current_timestamp), '%Y-%m-%d')) T GROUP BY \"日期\", \"累计付费有效大众用户总数\", \"有效学习超过30分钟大众用户数\", \"有效学习大众用户占比\", \"有效学习大众用户数\", \"英语有效大众用户数\", \"语文有效大众用户数\", \"英语有效学习超过30分钟大众用户数\", \"语文有效学习超过30分钟大众用户数\") CT",
    "queryStats": {
      "createTime": "2022-08-02T08:45:50.148Z",
      "endTime": "2022-08-02T08:45:50.722Z",
      "queuedTime": "14.72ms",
      "elapsedTime": "574.07ms",
      "executionTime": "559.31ms",
      "totalDrivers": 114,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 114,
      "rawInputDataSize": "20.08kB",
      "rawInputPositions": 670,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "22.00ms",
      "totalScheduledTime": "507.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_080845_00208_gwi4x",
    "session": {
      "queryId": "20220802_080845_00208_gwi4x",
      "transactionId": "efc995c3-6f6a-423c-a416-f3c7b1454ffd",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659427725027,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_080845_00208_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt) dt,coalesce(t1.colName,t2.colName) colName,count1,count2 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and topic in ('point_engRecommend_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1 full outer join ( select t1.dt,count(distinct t1.student_id) count2,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisualContinuePlaying_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t2 on t1.dt = t2.dt and t1.colName = t2.colName ",
    "queryStats": {
      "createTime": "2022-08-02T08:08:45.029Z",
      "endTime": "2022-08-02T08:08:46.561Z",
      "queuedTime": "32.35ms",
      "elapsedTime": "1.53s",
      "executionTime": "1.50s",
      "totalDrivers": 617,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 617,
      "rawInputDataSize": "291.22MB",
      "rawInputPositions": 3366506,
      "cumulativeUserMemory": 3.3623815777E10,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "33.17MB",
      "totalCpuTime": "11.72s",
      "totalScheduledTime": "12.57s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083813_00231_gwi4x",
    "session": {
      "queryId": "20220802_083813_00231_gwi4x",
      "transactionId": "8d0e2e08-04ed-46cf-aba7-1d3fe6e2dc3d",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429493648,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083813_00231_gwi4x",
    "query": "SELECT  \"日期\",\"有效学习时长类型\",\"有效学习大众用户数\",\"英语科目有效学习大众用户数\",\"语文科目有效学习大众用户数\" FROM (select  \tdt as \"日期\"     ,study_type as \"有效学习时长类型\"     ,effect_num as \"有效学习大众用户数\"     ,eng_num as \"英语科目有效学习大众用户数\"     ,cn_num as \"语文科目有效学习大众用户数\" from hive.dwm.dwm_operate_kpi_effect where dt <= date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d') and dt >=date_format(date_add( 'day' ,-3, current_timestamp),'%Y-%m-%d')) T GROUP BY \"日期\",\"有效学习时长类型\",\"有效学习大众用户数\",\"英语科目有效学习大众用户数\",\"语文科目有效学习大众用户数\" ",
    "queryStats": {
      "createTime": "2022-08-02T08:38:13.648Z",
      "endTime": "2022-08-02T08:38:13.697Z",
      "queuedTime": "13.03ms",
      "elapsedTime": "49.70ms",
      "executionTime": "36.62ms",
      "totalDrivers": 17,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 17,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "1.00ms",
      "totalScheduledTime": "1.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_063700_00156_gwi4x",
    "session": {
      "queryId": "20220802_063700_00156_gwi4x",
      "transactionId": "2068a2f0-e3c8-49b2-9558-4d86be7641c6",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422220155,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_063700_00156_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T06:37:00.156Z",
      "endTime": "2022-08-02T06:37:00.536Z",
      "queuedTime": "28.41ms",
      "elapsedTime": "380.86ms",
      "executionTime": "352.41ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "13.52MB",
      "rawInputPositions": 19741,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "1.87s",
      "totalScheduledTime": "2.15s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_080547_00204_gwi4x",
    "session": {
      "queryId": "20220802_080547_00204_gwi4x",
      "transactionId": "01c86523-ad06-4fd0-b844-04d90e0ea490",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659427547814,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_080547_00204_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt,t3.dt,t4.dt) dt,coalesce(t1.colName,t2.colName,t3.colName,t4.colName) colName,count1,count2,count3,count4 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_wisdom_librarySearchZF_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1 full outer join ( select t1.dt,count(distinct t1.student_id) count2,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisual_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t2 on t1.dt = t2.dt and t1.colName = t2.colName full outer join ( select t1.dt,count(distinct t1.student_id) count3,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendShow_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t3 on t1.dt = t3.dt and t1.colName = t3.colName full outer join ( select t1.dt,count(t1.student_id) count4,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_math_mainhome_pv_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t4 on t1.dt = t4.dt and t1.colName = t4.colName ",
    "queryStats": {
      "createTime": "2022-08-02T08:05:47.815Z",
      "endTime": "2022-08-02T08:05:52.277Z",
      "queuedTime": "34.11ms",
      "elapsedTime": "4.46s",
      "executionTime": "4.43s",
      "totalDrivers": 1416,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 1416,
      "rawInputDataSize": "988.82MB",
      "rawInputPositions": 42515696,
      "cumulativeUserMemory": 2.190839122291E12,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "700.09MB",
      "totalCpuTime": "1.52m",
      "totalScheduledTime": "2.54m",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083700_00227_gwi4x",
    "session": {
      "queryId": "20220802_083700_00227_gwi4x",
      "transactionId": "bf0a2906-7033-4d3e-989d-88a6c66e4335",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429420445,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083700_00227_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T08:37:00.446Z",
      "endTime": "2022-08-02T08:37:00.857Z",
      "queuedTime": "29.25ms",
      "elapsedTime": "411.85ms",
      "executionTime": "382.57ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "16.95MB",
      "rawInputPositions": 24766,
      "cumulativeUserMemory": 9.9203807E7,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.37s",
      "totalScheduledTime": "2.75s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_075159_00197_gwi4x",
    "session": {
      "queryId": "20220802_075159_00197_gwi4x",
      "transactionId": "5d3c29b7-47e9-4e2f-b20c-9f72e36354af",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659426719889,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_075159_00197_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T07:51:59.890Z",
      "endTime": "2022-08-02T07:52:00.272Z",
      "queuedTime": "28.38ms",
      "elapsedTime": "382.29ms",
      "executionTime": "353.85ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "15.75MB",
      "rawInputPositions": 22993,
      "cumulativeUserMemory": 2.621212739E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.90s",
      "totalScheduledTime": "3.15s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083824_00234_gwi4x",
    "session": {
      "queryId": "20220802_083824_00234_gwi4x",
      "transactionId": "969d6683-d1ae-4722-9e67-39621af200cc",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429504242,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083824_00234_gwi4x",
    "query": "SELECT  \"日期\" ,  sum(\"pad端活跃人数\") AS \"sum(pad端活跃人数)\",sum(\"pad端4到12岁活跃人数\") AS \"sum(pad端4到12岁活跃人数)\",sum(\"风采秀家长伴读页活跃家长数\") AS \"sum(风采秀家长伴读页活跃家长数)\",sum(\"风采秀家长伴读页活跃4-12岁学生家长数\") AS \"sum(风采秀家长伴读页活跃4-12岁学生家长数)\" FROM (SELECT  \tread_day as \"日期\"    ,pad_active as \"pad端活跃人数\"    ,pad_4to12_active as \"pad端4到12岁活跃人数\"    ,parent_active as \"风采秀家长伴读页活跃家长数\"    ,parent_4to12_active as \"风采秀家长伴读页活跃4-12岁学生家长数\" from dwm.dwm_fcx_parent_active where dt = date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d')) T GROUP BY \"日期\" ORDER BY \"日期\" asc ",
    "queryStats": {
      "createTime": "2022-08-02T08:38:24.242Z",
      "endTime": "2022-08-02T08:38:24.428Z",
      "queuedTime": "25.12ms",
      "elapsedTime": "186.13ms",
      "executionTime": "160.97ms",
      "totalDrivers": 149,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 149,
      "rawInputDataSize": "4.91kB",
      "rawInputPositions": 519,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "54.00ms",
      "totalScheduledTime": "116.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083604_00222_gwi4x",
    "session": {
      "queryId": "20220802_083604_00222_gwi4x",
      "transactionId": "61e35bb2-9b5c-4e40-89f4-6a20824704cd",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429364667,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083604_00222_gwi4x",
    "query": "SELECT DISTINCT T.\"roam_agent_name\" FROM (select    * from hive.tmp.tmp_student_roam_result_new where dt >= date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d') and dt <= date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d')) T ORDER BY T.\"roam_agent_name\" ",
    "queryStats": {
      "createTime": "2022-08-02T08:36:04.667Z",
      "endTime": "2022-08-02T08:36:04.759Z",
      "queuedTime": "14.69ms",
      "elapsedTime": "92.54ms",
      "executionTime": "77.80ms",
      "totalDrivers": 149,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 149,
      "rawInputDataSize": "11.05kB",
      "rawInputPositions": 299,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "16.00ms",
      "totalScheduledTime": "29.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_065159_00178_gwi4x",
    "session": {
      "queryId": "20220802_065159_00178_gwi4x",
      "transactionId": "a453fb9f-569c-4470-bdfe-8d8ac4e6b5b8",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659423119728,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_065159_00178_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T06:51:59.729Z",
      "endTime": "2022-08-02T06:52:00.109Z",
      "queuedTime": "28.85ms",
      "elapsedTime": "380.90ms",
      "executionTime": "352.01ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "13.99MB",
      "rawInputPositions": 20437,
      "cumulativeUserMemory": 6.32500195E8,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.41s",
      "totalScheduledTime": "2.68s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_070922_00187_gwi4x",
    "session": {
      "queryId": "20220802_070922_00187_gwi4x",
      "transactionId": "bd740ffb-9203-4e3f-a946-f3097095a900",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659424162658,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FAILED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_070922_00187_gwi4x",
    "query": "select 1",
    "queryStats": {
      "createTime": "2022-08-02T07:09:22.658Z",
      "endTime": "2022-08-02T07:09:22.670Z",
      "queuedTime": "361.15us",
      "elapsedTime": "12.67ms",
      "executionTime": "12.27ms",
      "totalDrivers": 17,
      "queuedDrivers": 11,
      "runningDrivers": 5,
      "completedDrivers": 1,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "176B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "0.00ns",
      "totalScheduledTime": "0.00ns",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 5.882352941176471
    },
    "errorType": "USER_ERROR",
    "errorCode": {
      "code": 3,
      "name": "USER_CANCELED",
      "type": "USER_ERROR"
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_080943_00211_gwi4x",
    "session": {
      "queryId": "20220802_080943_00211_gwi4x",
      "transactionId": "5b83413a-ccfb-4b6b-b4a1-f9543122b69c",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659427783942,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_080943_00211_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt) dt,coalesce(t1.colName,t2.colName) colName,count1,count2 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendOver_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1 full outer join ( select t1.dt,count(t1.student_id) count2,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisualContinuePlaying_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t2 on t1.dt = t2.dt and t1.colName = t2.colName ",
    "queryStats": {
      "createTime": "2022-08-02T08:09:43.943Z",
      "endTime": "2022-08-02T08:09:48.452Z",
      "queuedTime": "50.41ms",
      "elapsedTime": "4.51s",
      "executionTime": "4.46s",
      "totalDrivers": 764,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 764,
      "rawInputDataSize": "3.59GB",
      "rawInputPositions": 25496726,
      "cumulativeUserMemory": 1.125202724602E12,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "414.47MB",
      "totalCpuTime": "3.76m",
      "totalScheduledTime": "6.95m",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_064045_00172_gwi4x",
    "session": {
      "queryId": "20220802_064045_00172_gwi4x",
      "transactionId": "b22831ad-727d-498e-ab46-14daf84eb7f4",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422445870,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_064045_00172_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T06:40:45.871Z",
      "endTime": "2022-08-02T06:40:46.713Z",
      "queuedTime": "456.39us",
      "elapsedTime": "842.01ms",
      "executionTime": "841.53ms",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "215.28kB",
      "rawInputPositions": 4792,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "55.00ms",
      "totalScheduledTime": "811.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_063850_00163_gwi4x",
    "session": {
      "queryId": "20220802_063850_00163_gwi4x",
      "transactionId": "8977f23c-1b7c-4173-ad38-dc1debb6edfc",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422330227,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FAILED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_063850_00163_gwi4x",
    "query": "select 1",
    "queryStats": {
      "createTime": "2022-08-02T06:38:50.228Z",
      "endTime": "2022-08-02T06:38:50.237Z",
      "queuedTime": "169.60us",
      "elapsedTime": "9.73ms",
      "executionTime": "9.54ms",
      "totalDrivers": 17,
      "queuedDrivers": 13,
      "runningDrivers": 4,
      "completedDrivers": 0,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "176B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "0.00ns",
      "totalScheduledTime": "0.00ns",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 0.0
    },
    "errorType": "USER_ERROR",
    "errorCode": {
      "code": 3,
      "name": "USER_CANCELED",
      "type": "USER_ERROR"
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083741_00228_gwi4x",
    "session": {
      "queryId": "20220802_083741_00228_gwi4x",
      "transactionId": "6c6fe442-3a27-4584-8e79-14bec089e18a",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429461161,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083741_00228_gwi4x",
    "query": "SELECT COUNT(*) FROM (SELECT \"日期\", \"累计付费有效大众用户总数\", \"有效学习超过30分钟大众用户数\", \"有效学习大众用户占比\", \"有效学习大众用户数\", \"英语有效大众用户数\", \"语文有效大众用户数\", \"英语有效学习超过30分钟大众用户数\", \"语文有效学习超过30分钟大众用户数\" FROM (SELECT create_time AS \"日期\", total_effective AS \"累计付费有效大众用户总数\", over_total AS \"有效学习超过30分钟大众用户数\", round(effective_proportion, 4) AS \"有效学习大众用户占比\", all_total AS \"有效学习大众用户数\", en_effective AS \"英语有效大众用户数\", cn_effective AS \"语文有效大众用户数\", en_over_total AS \"英语有效学习超过30分钟大众用户数\", cn_over_total AS \"语文有效学习超过30分钟大众用户数\" FROM hive.dwm.dwm_operate_kpi_entirety WHERE dt = date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d') AND create_time <= date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d') AND create_time >= date_format(date_add('day', -7, current_timestamp), '%Y-%m-%d')) T GROUP BY \"日期\", \"累计付费有效大众用户总数\", \"有效学习超过30分钟大众用户数\", \"有效学习大众用户占比\", \"有效学习大众用户数\", \"英语有效大众用户数\", \"语文有效大众用户数\", \"英语有效学习超过30分钟大众用户数\", \"语文有效学习超过30分钟大众用户数\") CT",
    "queryStats": {
      "createTime": "2022-08-02T08:37:41.162Z",
      "endTime": "2022-08-02T08:37:41.288Z",
      "queuedTime": "13.77ms",
      "elapsedTime": "126.32ms",
      "executionTime": "112.51ms",
      "totalDrivers": 114,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 114,
      "rawInputDataSize": "20.08kB",
      "rawInputPositions": 670,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "52.00ms",
      "totalScheduledTime": "96.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084126_00241_gwi4x",
    "session": {
      "queryId": "20220802_084126_00241_gwi4x",
      "transactionId": "66c5264b-9b87-4631-9046-0dbbcda8ec75",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429686051,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084126_00241_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_CAT = 'hive' AND TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE', 'VIEW')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T08:41:26.051Z",
      "endTime": "2022-08-02T08:41:27.651Z",
      "queuedTime": "535.71us",
      "elapsedTime": "1.60s",
      "executionTime": "1.60s",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "194.28kB",
      "rawInputPositions": 4107,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "67.00ms",
      "totalScheduledTime": "1.57s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_082159_00215_gwi4x",
    "session": {
      "queryId": "20220802_082159_00215_gwi4x",
      "transactionId": "5af85769-3595-4e94-9d98-4e473cff214c",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659428519963,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_082159_00215_gwi4x",
    "query": "select count(distinct a.user_id) as enter_num,\ncount(distinct b.user_id)as quit_num,\na.point_min\nfrom (\nSELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_enter_topic where dt=cast(current_date as varchar)\n   )a\n   left join\n   (\n   SELECT cast(json_extract(replace(sourcedata,'$',''),'$.user_id') as decimal(20,0)) AS user_id,\n          concat(substr(format_datetime(from_unixtime(cast(json_extract(replace(sourcedata,'$',''),'$.time') as decimal(20,0))/1000),'yyyy-MM-dd HH:mm'),1,15),'0') AS point_min\n   FROM hive.ods_point.point_en_etpdasai_cocos_url_quit_topic where dt=cast(current_date as varchar)\n   \n   )b on a.point_min=b.point_min\n   group by a.point_min\n   order by a.point_min",
    "queryStats": {
      "createTime": "2022-08-02T08:21:59.964Z",
      "endTime": "2022-08-02T08:22:00.358Z",
      "queuedTime": "27.60ms",
      "elapsedTime": "394.68ms",
      "executionTime": "367.03ms",
      "totalDrivers": 254,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 254,
      "rawInputDataSize": "16.57MB",
      "rawInputPositions": 24178,
      "cumulativeUserMemory": 1.765942414E9,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "2.35s",
      "totalScheduledTime": "2.67s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084615_00252_gwi4x",
    "session": {
      "queryId": "20220802_084615_00252_gwi4x",
      "transactionId": "367c46e7-dec9-4137-8be4-ff4ba63e66f0",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429975541,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084615_00252_gwi4x",
    "query": "SELECT  \"灰度用户的日期\",\"ipad活跃灰度用户数量(活跃用户指 英语学习时长+磨耳朵的时长 >=0)\",\"ipad活跃灰度用户开启习惯闹钟的用户量\",\"开启习惯闹钟并且完成习惯闹钟任务的灰度用户数\",\"开启习惯闹钟并且完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\",\"开启习惯闹钟并且未完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\",\"登录成长乐园灰度用户数量\",\"登录成长乐园并且开启习惯闹钟的灰度用户数量\",\"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户数量\",\"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\",\"登录成长乐园并且开启习惯闹钟并完未成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\" FROM (select \tdate_day  as \"灰度用户的日期\"     ,ipad_active_user_num  as  \"ipad活跃灰度用户数量(活跃用户指 英语学习时长+磨耳朵的时长 >=0)\"     ,ipad_active_habit_clock_user_num as  \"ipad活跃灰度用户开启习惯闹钟的用户量\"      ,habit_clock_and_finish_habit_task_gray_student_num  as  \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户数\"     ,habit_clock_and_finish_habit_task_gray_student_avg_study_duration as \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\"     ,habit_clock_and_unfinish_habit_task_gray_student_avg_study_duration as  \"开启习惯闹钟并且未完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\"     ,gray_student_active_user_num  as  \"登录成长乐园灰度用户数量\"     ,gray_student_habit_clock_user_num as  \"登录成长乐园并且开启习惯闹钟的灰度用户数量\"      ,finish_task_gray_student_num  as  \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户数量\"     ,finish_task_gray_student_avg_study_duration as  \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\"     ,unfinish_task_gray_student_avg_study_duration as  \"登录成长乐园并且开启习惯闹钟并完未成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\"  from hive.growth_paradise.app_gray_student_total where dt=date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d')) T GROUP BY \"灰度用户的日期\",\"ipad活跃灰度用户数量(活跃用户指 英语学习时长+磨耳朵的时长 >=0)\",\"ipad活跃灰度用户开启习惯闹钟的用户量\",\"开启习惯闹钟并且完成习惯闹钟任务的灰度用户数\",\"开启习惯闹钟并且完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\",\"开启习惯闹钟并且未完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\",\"登录成长乐园灰度用户数量\",\"登录成长乐园并且开启习惯闹钟的灰度用户数量\",\"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户数量\",\"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\",\"登录成长乐园并且开启习惯闹钟并完未成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\" ORDER BY \"灰度用户的日期\" desc ",
    "queryStats": {
      "createTime": "2022-08-02T08:46:15.543Z",
      "endTime": "2022-08-02T08:46:15.606Z",
      "queuedTime": "13.89ms",
      "elapsedTime": "63.50ms",
      "executionTime": "49.56ms",
      "totalDrivers": 69,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 69,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "6.00ms",
      "totalScheduledTime": "15.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_064025_00169_gwi4x",
    "session": {
      "queryId": "20220802_064025_00169_gwi4x",
      "transactionId": "1d17ef3f-1668-4bcc-8f88-e4d7dacd6807",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422425718,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FAILED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_064025_00169_gwi4x",
    "query": "select 1",
    "queryStats": {
      "createTime": "2022-08-02T06:40:25.718Z",
      "endTime": "2022-08-02T06:40:25.731Z",
      "queuedTime": "164.45us",
      "elapsedTime": "13.37ms",
      "executionTime": "13.16ms",
      "totalDrivers": 17,
      "queuedDrivers": 0,
      "runningDrivers": 5,
      "completedDrivers": 12,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "474B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "1.00ms",
      "totalScheduledTime": "1.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 70.58823529411765
    },
    "errorType": "USER_ERROR",
    "errorCode": {
      "code": 3,
      "name": "USER_CANCELED",
      "type": "USER_ERROR"
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_075659_00202_gwi4x",
    "session": {
      "queryId": "20220802_075659_00202_gwi4x",
      "transactionId": "971ab66e-8471-4474-b101-a49a8ef43d1d",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659427019353,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_075659_00202_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt) dt,coalesce(t1.colName,t2.colName) colName,count1,count2 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_wisdom_librarySearchZF_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1 full outer join ( select t1.dt,count(distinct t1.student_id) count2,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisual_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t2 on t1.dt = t2.dt and t1.colName = t2.colName ",
    "queryStats": {
      "createTime": "2022-08-02T07:56:59.354Z",
      "endTime": "2022-08-02T07:57:03.351Z",
      "queuedTime": "30.89ms",
      "elapsedTime": "4.00s",
      "executionTime": "3.97s",
      "totalDrivers": 703,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 703,
      "rawInputDataSize": "885.85MB",
      "rawInputPositions": 21840908,
      "cumulativeUserMemory": 1.440730839219E12,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "460.44MB",
      "totalCpuTime": "1.18m",
      "totalScheduledTime": "1.42m",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_064959_00177_gwi4x",
    "session": {
      "queryId": "20220802_064959_00177_gwi4x",
      "transactionId": "5bf6cdcb-45ed-4db7-a5bb-eba6262b41ad",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422999997,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_064959_00177_gwi4x",
    "query": "select count(distinct t1.student_id ) ,count(distinct case when t1.min_time < t2.max_time then t2.student_id else null end ) from ( select t1.student_id ,min(t1.time) AS min_time,max(t1.time) AS max_time from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,\n cast(json_extract_scalar(sourcedata, '$.time') as bigint) as time from (select regexp_replace(source,'\\$','') as sourcedata,source from hive.ods_point.all_point where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and topic = 'point_engRecommendAudiovisual_topic') tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1  GROUP BY t1.student_id) t1 inner join (select student_id from hive.dwd.dwd_st_student_basic_info where dt >= '2022-08-01' and dt <= '2022-08-01' GROUP BY student_id) student on t1.student_id = student.student_id  left join ( select t1.student_id ,min(t1.time) AS min_time,max(t1.time) AS max_time from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,\n cast(json_extract_scalar(sourcedata, '$.time') as bigint) as time from (select regexp_replace(source,'\\$','') as sourcedata,source from hive.ods_point.all_point where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and topic = 'point_engRecommendAudiovisualBack_topic') tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1  GROUP BY t1.student_id) t2 on t1.student_id = t2.student_id ",
    "queryStats": {
      "createTime": "2022-08-02T06:49:59.998Z",
      "endTime": "2022-08-02T06:50:01.341Z",
      "queuedTime": "32.01ms",
      "elapsedTime": "1.34s",
      "executionTime": "1.31s",
      "totalDrivers": 415,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 415,
      "rawInputDataSize": "117.68MB",
      "rawInputPositions": 1651372,
      "cumulativeUserMemory": 1.47111819072E11,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "188.31MB",
      "totalCpuTime": "6.08s",
      "totalScheduledTime": "6.67s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083850_00236_gwi4x",
    "session": {
      "queryId": "20220802_083850_00236_gwi4x",
      "transactionId": "7ed7c26f-82bc-4620-a859-b5161365bd17",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429530970,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083850_00236_gwi4x",
    "query": "SELECT COUNT(*) FROM (SELECT \"灰度用户的日期\", \"ipad活跃灰度用户数量(活跃用户指 英语学习时长+磨耳朵的时长 >=0)\", \"ipad活跃灰度用户开启习惯闹钟的用户量\", \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户数\", \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", \"开启习惯闹钟并且未完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", \"登录成长乐园灰度用户数量\", \"登录成长乐园并且开启习惯闹钟的灰度用户数量\", \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户数量\", \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", \"登录成长乐园并且开启习惯闹钟并完未成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\" FROM (SELECT date_day AS \"灰度用户的日期\", ipad_active_user_num AS \"ipad活跃灰度用户数量(活跃用户指 英语学习时长+磨耳朵的时长 >=0)\", ipad_active_habit_clock_user_num AS \"ipad活跃灰度用户开启习惯闹钟的用户量\", habit_clock_and_finish_habit_task_gray_student_num AS \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户数\", habit_clock_and_finish_habit_task_gray_student_avg_study_duration AS \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", habit_clock_and_unfinish_habit_task_gray_student_avg_study_duration AS \"开启习惯闹钟并且未完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", gray_student_active_user_num AS \"登录成长乐园灰度用户数量\", gray_student_habit_clock_user_num AS \"登录成长乐园并且开启习惯闹钟的灰度用户数量\", finish_task_gray_student_num AS \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户数量\", finish_task_gray_student_avg_study_duration AS \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", unfinish_task_gray_student_avg_study_duration AS \"登录成长乐园并且开启习惯闹钟并完未成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\" FROM hive.growth_paradise.app_gray_student_total WHERE dt = date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d')) T GROUP BY \"灰度用户的日期\", \"ipad活跃灰度用户数量(活跃用户指 英语学习时长+磨耳朵的时长 >=0)\", \"ipad活跃灰度用户开启习惯闹钟的用户量\", \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户数\", \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", \"开启习惯闹钟并且未完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", \"登录成长乐园灰度用户数量\", \"登录成长乐园并且开启习惯闹钟的灰度用户数量\", \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户数量\", \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", \"登录成长乐园并且开启习惯闹钟并完未成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\") CT",
    "queryStats": {
      "createTime": "2022-08-02T08:38:50.973Z",
      "endTime": "2022-08-02T08:38:51.039Z",
      "queuedTime": "17.15ms",
      "elapsedTime": "66.89ms",
      "executionTime": "49.69ms",
      "totalDrivers": 18,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 18,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "3.00ms",
      "totalScheduledTime": "6.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_071005_00189_gwi4x",
    "session": {
      "queryId": "20220802_071005_00189_gwi4x",
      "transactionId": "17ea25ca-86b7-4e61-847e-110abc8411de",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659424205744,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FAILED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_071005_00189_gwi4x",
    "query": "select 1",
    "queryStats": {
      "createTime": "2022-08-02T07:10:05.745Z",
      "endTime": "2022-08-02T07:10:05.758Z",
      "queuedTime": "165.26us",
      "elapsedTime": "13.99ms",
      "executionTime": "13.78ms",
      "totalDrivers": 17,
      "queuedDrivers": 11,
      "runningDrivers": 3,
      "completedDrivers": 3,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "0.00ns",
      "totalScheduledTime": "12.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 17.647058823529413
    },
    "errorType": "USER_ERROR",
    "errorCode": {
      "code": 3,
      "name": "USER_CANCELED",
      "type": "USER_ERROR"
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083851_00237_gwi4x",
    "session": {
      "queryId": "20220802_083851_00237_gwi4x",
      "transactionId": "235d05bf-b823-4dec-8486-47844111c8ff",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429531045,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083851_00237_gwi4x",
    "query": "SELECT  \"灰度用户的日期\",\"ipad活跃灰度用户数量(活跃用户指 英语学习时长+磨耳朵的时长 >=0)\",\"ipad活跃灰度用户开启习惯闹钟的用户量\",\"开启习惯闹钟并且完成习惯闹钟任务的灰度用户数\",\"开启习惯闹钟并且完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\",\"开启习惯闹钟并且未完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\",\"登录成长乐园灰度用户数量\",\"登录成长乐园并且开启习惯闹钟的灰度用户数量\",\"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户数量\",\"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\",\"登录成长乐园并且开启习惯闹钟并完未成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\" FROM (select \tdate_day  as \"灰度用户的日期\"     ,ipad_active_user_num  as  \"ipad活跃灰度用户数量(活跃用户指 英语学习时长+磨耳朵的时长 >=0)\"     ,ipad_active_habit_clock_user_num as  \"ipad活跃灰度用户开启习惯闹钟的用户量\"      ,habit_clock_and_finish_habit_task_gray_student_num  as  \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户数\"     ,habit_clock_and_finish_habit_task_gray_student_avg_study_duration as \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\"     ,habit_clock_and_unfinish_habit_task_gray_student_avg_study_duration as  \"开启习惯闹钟并且未完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\"     ,gray_student_active_user_num  as  \"登录成长乐园灰度用户数量\"     ,gray_student_habit_clock_user_num as  \"登录成长乐园并且开启习惯闹钟的灰度用户数量\"      ,finish_task_gray_student_num  as  \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户数量\"     ,finish_task_gray_student_avg_study_duration as  \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\"     ,unfinish_task_gray_student_avg_study_duration as  \"登录成长乐园并且开启习惯闹钟并完未成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\"  from hive.growth_paradise.app_gray_student_total where dt=date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d')) T GROUP BY \"灰度用户的日期\",\"ipad活跃灰度用户数量(活跃用户指 英语学习时长+磨耳朵的时长 >=0)\",\"ipad活跃灰度用户开启习惯闹钟的用户量\",\"开启习惯闹钟并且完成习惯闹钟任务的灰度用户数\",\"开启习惯闹钟并且完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\",\"开启习惯闹钟并且未完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\",\"登录成长乐园灰度用户数量\",\"登录成长乐园并且开启习惯闹钟的灰度用户数量\",\"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户数量\",\"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\",\"登录成长乐园并且开启习惯闹钟并完未成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\" ORDER BY \"灰度用户的日期\" desc ",
    "queryStats": {
      "createTime": "2022-08-02T08:38:51.046Z",
      "endTime": "2022-08-02T08:38:51.097Z",
      "queuedTime": "12.86ms",
      "elapsedTime": "51.63ms",
      "executionTime": "38.74ms",
      "totalDrivers": 69,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 69,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "6.00ms",
      "totalScheduledTime": "16.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_063900_00165_gwi4x",
    "session": {
      "queryId": "20220802_063900_00165_gwi4x",
      "transactionId": "e2c75f06-6f84-4eee-94f5-2b5cc1d98d96",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422340541,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FAILED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_063900_00165_gwi4x",
    "query": "select 1",
    "queryStats": {
      "createTime": "2022-08-02T06:39:00.541Z",
      "endTime": "2022-08-02T06:39:00.552Z",
      "queuedTime": "177.40us",
      "elapsedTime": "11.95ms",
      "executionTime": "11.73ms",
      "totalDrivers": 17,
      "queuedDrivers": 17,
      "runningDrivers": 0,
      "completedDrivers": 0,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "0.00ns",
      "totalScheduledTime": "0.00ns",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 0.0
    },
    "errorType": "USER_ERROR",
    "errorCode": {
      "code": 3,
      "name": "USER_CANCELED",
      "type": "USER_ERROR"
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_064118_00175_gwi4x",
    "session": {
      "queryId": "20220802_064118_00175_gwi4x",
      "transactionId": "c4aa4a08-0cd8-436f-836f-a878578e8421",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659422478146,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FAILED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_064118_00175_gwi4x",
    "query": "select 1",
    "queryStats": {
      "createTime": "2022-08-02T06:41:18.146Z",
      "endTime": "2022-08-02T06:41:18.160Z",
      "queuedTime": "205.02us",
      "elapsedTime": "15.00ms",
      "executionTime": "14.75ms",
      "totalDrivers": 17,
      "queuedDrivers": 9,
      "runningDrivers": 5,
      "completedDrivers": 3,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "0.00ns",
      "totalScheduledTime": "0.00ns",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 17.647058823529413
    },
    "errorType": "USER_ERROR",
    "errorCode": {
      "code": 3,
      "name": "USER_CANCELED",
      "type": "USER_ERROR"
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083813_00230_gwi4x",
    "session": {
      "queryId": "20220802_083813_00230_gwi4x",
      "transactionId": "03ce2037-b2c9-4cc0-a875-1c72cbc0094e",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429493571,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083813_00230_gwi4x",
    "query": "SELECT COUNT(*) FROM (SELECT \"日期\", \"有效学习时长类型\", \"有效学习大众用户数\", \"英语科目有效学习大众用户数\", \"语文科目有效学习大众用户数\" FROM (SELECT dt AS \"日期\", study_type AS \"有效学习时长类型\", effect_num AS \"有效学习大众用户数\", eng_num AS \"英语科目有效学习大众用户数\", cn_num AS \"语文科目有效学习大众用户数\" FROM hive.dwm.dwm_operate_kpi_effect WHERE dt <= date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d') AND dt >= date_format(date_add('day', -3, current_timestamp), '%Y-%m-%d')) T GROUP BY \"日期\", \"有效学习时长类型\", \"有效学习大众用户数\", \"英语科目有效学习大众用户数\", \"语文科目有效学习大众用户数\") CT",
    "queryStats": {
      "createTime": "2022-08-02T08:38:13.572Z",
      "endTime": "2022-08-02T08:38:13.642Z",
      "queuedTime": "24.31ms",
      "elapsedTime": "70.92ms",
      "executionTime": "46.57ms",
      "totalDrivers": 18,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 18,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "3.00ms",
      "totalScheduledTime": "5.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_070241_00184_gwi4x",
    "session": {
      "queryId": "20220802_070241_00184_gwi4x",
      "transactionId": "d77af436-c522-4a04-beb6-1f2a2c4b1968",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659423761150,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_070241_00184_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt) dt,count1,count2 from  ( select t1.dt,count(t1.student_id) count1 from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisualBack_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt ) t1 full outer join ( select t1.dt,count(t1.student_id) count2 from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_wisdom_librarySearch_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt ) t2 on t1.dt = t2.dt ",
    "queryStats": {
      "createTime": "2022-08-02T07:02:41.151Z",
      "endTime": "2022-08-02T07:02:44.503Z",
      "queuedTime": "37.27ms",
      "elapsedTime": "3.35s",
      "executionTime": "3.32s",
      "totalDrivers": 625,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 625,
      "rawInputDataSize": "138.41MB",
      "rawInputPositions": 20733473,
      "cumulativeUserMemory": 1.034564103889E12,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "405.83MB",
      "totalCpuTime": "25.84s",
      "totalScheduledTime": "33.62s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_081241_00214_gwi4x",
    "session": {
      "queryId": "20220802_081241_00214_gwi4x",
      "transactionId": "008edf95-d205-4073-962e-3daa13f40843",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659427961794,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_081241_00214_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt) dt,coalesce(t1.colName,t2.colName) colName,count1,count2 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendOver_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1 full outer join ( select t1.dt,count(distinct t1.student_id) count2,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommend_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t2 on t1.dt = t2.dt and t1.colName = t2.colName ",
    "queryStats": {
      "createTime": "2022-08-02T08:12:41.795Z",
      "endTime": "2022-08-02T08:12:47.864Z",
      "queuedTime": "31.73ms",
      "elapsedTime": "6.07s",
      "executionTime": "6.04s",
      "totalDrivers": 845,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 845,
      "rawInputDataSize": "5.52GB",
      "rawInputPositions": 28364805,
      "cumulativeUserMemory": 2.11939690029E12,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "579.00MB",
      "totalCpuTime": "5.69m",
      "totalScheduledTime": "13.16m",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_080616_00205_gwi4x",
    "session": {
      "queryId": "20220802_080616_00205_gwi4x",
      "transactionId": "88a364ac-cbbe-46ff-bc53-f4bf55fa2f18",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659427576554,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_080616_00205_gwi4x",
    "query": "select coalesce(t1.dt,t2.dt,t3.dt,t4.dt) dt,coalesce(t1.colName,t2.colName,t3.colName,t4.colName) colName,count1,count2,count3,count4 from  ( select t1.dt,count(distinct t1.student_id) count1,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_wisdom_librarySearchZF_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t1 full outer join ( select t1.dt,count(distinct t1.student_id) count2,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisual_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t2 on t1.dt = t2.dt and t1.colName = t2.colName full outer join ( select t1.dt,count(distinct t1.student_id) count3,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_engRecommendAudiovisualContinuePlaying_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t3 on t1.dt = t3.dt and t1.colName = t3.colName full outer join ( select t1.dt,count(t1.student_id) count4,t2.gender as colName from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,dt from (select regexp_replace(source,'\\$','') as sourcedata,dt from hive.ods_point.all_point where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and topic in ('point_math_mainhome_pv_topic')) tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1 inner join (select student_id,dt,gender from hive.dwd.dwd_st_student_basic_info where 1 = 1 and dt >= '2022-07-26' and dt <= '2022-08-01' and extral_payment_time is not null ) t2 on t1.student_id = t2.student_id and t1.dt = t2.dt where 1 = 1 group by t1.dt,gender ) t4 on t1.dt = t4.dt and t1.colName = t4.colName ",
    "queryStats": {
      "createTime": "2022-08-02T08:06:16.556Z",
      "endTime": "2022-08-02T08:06:21.330Z",
      "queuedTime": "36.90ms",
      "elapsedTime": "4.77s",
      "executionTime": "4.74s",
      "totalDrivers": 1425,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 1425,
      "rawInputDataSize": "989.23MB",
      "rawInputPositions": 42516252,
      "cumulativeUserMemory": 2.568440788559E12,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "704.52MB",
      "totalCpuTime": "1.58m",
      "totalScheduledTime": "2.79m",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083521_00219_gwi4x",
    "session": {
      "queryId": "20220802_083521_00219_gwi4x",
      "transactionId": "d8284458-1475-4220-94d5-d033b9026783",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429321039,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083521_00219_gwi4x",
    "query": "SELECT  \"roam_agent_name\",\"student_id\",\"student_name\",\"last_valid_time\",\"student_age\",\"phone_number\",\"student_province\",\"student_city\",\"total_read_second\",\"etp_second_time\",\"book_readsecond_time\",\"video_readsecond_time\",\"eesecond_time\",\"exercise_readsecond_time\",\"playsecond_time\",\"readwordnum\",\"read_day\" FROM (select    * from hive.tmp.tmp_student_roam_result_new where dt >= date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d') and dt <= date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d')) T GROUP BY \"roam_agent_name\",\"student_id\",\"student_name\",\"last_valid_time\",\"student_age\",\"phone_number\",\"student_province\",\"student_city\",\"total_read_second\",\"etp_second_time\",\"book_readsecond_time\",\"video_readsecond_time\",\"eesecond_time\",\"exercise_readsecond_time\",\"playsecond_time\",\"readwordnum\",\"read_day\" ORDER BY \"read_day\" desc ",
    "queryStats": {
      "createTime": "2022-08-02T08:35:21.040Z",
      "endTime": "2022-08-02T08:35:21.140Z",
      "queuedTime": "16.22ms",
      "elapsedTime": "100.09ms",
      "executionTime": "83.84ms",
      "totalDrivers": 149,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 149,
      "rawInputDataSize": "11.05kB",
      "rawInputPositions": 299,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "46.00ms",
      "totalScheduledTime": "90.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083604_00223_gwi4x",
    "session": {
      "queryId": "20220802_083604_00223_gwi4x",
      "transactionId": "9d083aa2-4c57-4624-8d51-0c6e8bdd1c6c",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429364716,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083604_00223_gwi4x",
    "query": "SELECT COUNT(*) FROM (SELECT \"roam_agent_name\", \"student_id\", \"student_name\", \"last_valid_time\", \"student_age\", \"phone_number\", \"student_province\", \"student_city\", \"total_read_second\", \"etp_second_time\", \"book_readsecond_time\", \"video_readsecond_time\", \"eesecond_time\", \"exercise_readsecond_time\", \"playsecond_time\", \"readwordnum\", \"read_day\" FROM (SELECT * FROM hive.tmp.tmp_student_roam_result_new WHERE dt >= date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d') AND dt <= date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d')) T GROUP BY \"roam_agent_name\", \"student_id\", \"student_name\", \"last_valid_time\", \"student_age\", \"phone_number\", \"student_province\", \"student_city\", \"total_read_second\", \"etp_second_time\", \"book_readsecond_time\", \"video_readsecond_time\", \"eesecond_time\", \"exercise_readsecond_time\", \"playsecond_time\", \"readwordnum\", \"read_day\") CT",
    "queryStats": {
      "createTime": "2022-08-02T08:36:04.717Z",
      "endTime": "2022-08-02T08:36:04.813Z",
      "queuedTime": "14.26ms",
      "elapsedTime": "96.52ms",
      "executionTime": "82.23ms",
      "totalDrivers": 114,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 114,
      "rawInputDataSize": "11.05kB",
      "rawInputPositions": 299,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "34.00ms",
      "totalScheduledTime": "66.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_065209_00180_gwi4x",
    "session": {
      "queryId": "20220802_065209_00180_gwi4x",
      "transactionId": "4aa23f7a-5030-432c-bb91-8af0064f44de",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "172.28.30.190",
      "userAgent": "Presto JDBC Driver/312",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659423129821,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_065209_00180_gwi4x",
    "query": "select count(distinct t1.student_id ) ,count(distinct case when t1.min_time < t2.max_time then t2.student_id else null end ) from ( select t1.student_id ,min(t1.time) AS min_time,max(t1.time) AS max_time from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,\n cast(json_extract_scalar(sourcedata, '$.time') as bigint) as time from (select regexp_replace(source,'\\$','') as sourcedata,source from hive.ods_point.all_point where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and topic = 'point_engRecommendAudiovisual_topic') tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1  GROUP BY t1.student_id) t1 inner join (select student_id from hive.dwd.dwd_st_student_basic_info where dt >= '2022-08-01' and dt <= '2022-08-01' and gender ='1' GROUP BY student_id) student on t1.student_id = student.student_id  left join ( select t1.student_id ,min(t1.time) AS min_time,max(t1.time) AS max_time from ( select cast(json_extract_scalar(sourcedata, '$.user_id') as bigint) as student_id,\n cast(json_extract_scalar(sourcedata, '$.time') as bigint) as time from (select regexp_replace(source,'\\$','') as sourcedata,source from hive.ods_point.all_point where 1 = 1 and dt >= '2022-08-01' and dt <= '2022-08-01' and topic = 'point_engRecommendAudiovisualBack_topic') tmp where json_extract_scalar(sourcedata, '$.user_id')<>'null' and json_extract_scalar(sourcedata, '$.user_id')<>'') t1  GROUP BY t1.student_id) t2 on t1.student_id = t2.student_id ",
    "queryStats": {
      "createTime": "2022-08-02T06:52:09.822Z",
      "endTime": "2022-08-02T06:52:11.130Z",
      "queuedTime": "30.38ms",
      "elapsedTime": "1.31s",
      "executionTime": "1.28s",
      "totalDrivers": 415,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 415,
      "rawInputDataSize": "118.22MB",
      "rawInputPositions": 1651372,
      "cumulativeUserMemory": 7.1928631819E10,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "95.44MB",
      "totalCpuTime": "5.60s",
      "totalScheduledTime": "5.92s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_071012_00191_gwi4x",
    "session": {
      "queryId": "20220802_071012_00191_gwi4x",
      "transactionId": "32c16c91-0642-42c2-ad52-54813293f74b",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.155",
      "userAgent": "StatementClient/0.169",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659424212207,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FAILED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_071012_00191_gwi4x",
    "query": "select 1",
    "queryStats": {
      "createTime": "2022-08-02T07:10:12.207Z",
      "endTime": "2022-08-02T07:10:12.268Z",
      "queuedTime": "177.69us",
      "elapsedTime": "61.50ms",
      "executionTime": "61.28ms",
      "totalDrivers": 17,
      "queuedDrivers": 17,
      "runningDrivers": 0,
      "completedDrivers": 0,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "0.00ns",
      "totalScheduledTime": "0.00ns",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 0.0
    },
    "errorType": "USER_ERROR",
    "errorCode": {
      "code": 3,
      "name": "USER_CANCELED",
      "type": "USER_ERROR"
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084615_00251_gwi4x",
    "session": {
      "queryId": "20220802_084615_00251_gwi4x",
      "transactionId": "4dd6f146-4b0b-4ab0-a741-a85d643e048c",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429975471,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084615_00251_gwi4x",
    "query": "SELECT COUNT(*) FROM (SELECT \"灰度用户的日期\", \"ipad活跃灰度用户数量(活跃用户指 英语学习时长+磨耳朵的时长 >=0)\", \"ipad活跃灰度用户开启习惯闹钟的用户量\", \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户数\", \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", \"开启习惯闹钟并且未完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", \"登录成长乐园灰度用户数量\", \"登录成长乐园并且开启习惯闹钟的灰度用户数量\", \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户数量\", \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", \"登录成长乐园并且开启习惯闹钟并完未成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\" FROM (SELECT date_day AS \"灰度用户的日期\", ipad_active_user_num AS \"ipad活跃灰度用户数量(活跃用户指 英语学习时长+磨耳朵的时长 >=0)\", ipad_active_habit_clock_user_num AS \"ipad活跃灰度用户开启习惯闹钟的用户量\", habit_clock_and_finish_habit_task_gray_student_num AS \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户数\", habit_clock_and_finish_habit_task_gray_student_avg_study_duration AS \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", habit_clock_and_unfinish_habit_task_gray_student_avg_study_duration AS \"开启习惯闹钟并且未完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", gray_student_active_user_num AS \"登录成长乐园灰度用户数量\", gray_student_habit_clock_user_num AS \"登录成长乐园并且开启习惯闹钟的灰度用户数量\", finish_task_gray_student_num AS \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户数量\", finish_task_gray_student_avg_study_duration AS \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", unfinish_task_gray_student_avg_study_duration AS \"登录成长乐园并且开启习惯闹钟并完未成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\" FROM hive.growth_paradise.app_gray_student_total WHERE dt = date_format(date_add('day', -1, current_timestamp), '%Y-%m-%d')) T GROUP BY \"灰度用户的日期\", \"ipad活跃灰度用户数量(活跃用户指 英语学习时长+磨耳朵的时长 >=0)\", \"ipad活跃灰度用户开启习惯闹钟的用户量\", \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户数\", \"开启习惯闹钟并且完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", \"开启习惯闹钟并且未完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", \"登录成长乐园灰度用户数量\", \"登录成长乐园并且开启习惯闹钟的灰度用户数量\", \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户数量\", \"登录成长乐园并且开启习惯闹钟并完成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\", \"登录成长乐园并且开启习惯闹钟并完未成习惯闹钟任务的灰度用户平均学习时长，单位为：分钟\") CT",
    "queryStats": {
      "createTime": "2022-08-02T08:46:15.472Z",
      "endTime": "2022-08-02T08:46:15.535Z",
      "queuedTime": "18.65ms",
      "elapsedTime": "63.42ms",
      "executionTime": "44.73ms",
      "totalDrivers": 18,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 18,
      "rawInputDataSize": "0B",
      "rawInputPositions": 0,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "3.00ms",
      "totalScheduledTime": "8.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083908_00238_gwi4x",
    "session": {
      "queryId": "20220802_083908_00238_gwi4x",
      "transactionId": "59203f19-d20c-4cbf-9d89-22f6bc937508",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429548327,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083908_00238_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_CAT = 'hive' AND TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE', 'VIEW')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T08:39:08.328Z",
      "endTime": "2022-08-02T08:39:09.923Z",
      "queuedTime": "522.02us",
      "elapsedTime": "1.60s",
      "executionTime": "1.59s",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "194.28kB",
      "rawInputPositions": 4107,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "65.00ms",
      "totalScheduledTime": "1.57s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_084349_00245_gwi4x",
    "session": {
      "queryId": "20220802_084349_00245_gwi4x",
      "transactionId": "1cf91adc-532d-43f2-b7b8-4b5762f9a8cf",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429829092,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_084349_00245_gwi4x",
    "query": "SELECT TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TABLE_TYPE, REMARKS,\n  TYPE_CAT, TYPE_SCHEM, TYPE_NAME,   SELF_REFERENCING_COL_NAME, REF_GENERATION\nFROM system.jdbc.tables\nWHERE TABLE_CAT = 'hive' AND TABLE_NAME LIKE '%' ESCAPE '\\' AND TABLE_TYPE IN ('TABLE', 'VIEW')\nORDER BY TABLE_TYPE, TABLE_CAT, TABLE_SCHEM, TABLE_NAME",
    "queryStats": {
      "createTime": "2022-08-02T08:43:49.092Z",
      "endTime": "2022-08-02T08:43:50.706Z",
      "queuedTime": "666.16us",
      "elapsedTime": "1.61s",
      "executionTime": "1.61s",
      "totalDrivers": 53,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 53,
      "rawInputDataSize": "194.28kB",
      "rawInputPositions": 4107,
      "cumulativeUserMemory": 0.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "529.75kB",
      "totalCpuTime": "73.00ms",
      "totalScheduledTime": "1.58s",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  },
  {
    "queryId": "20220802_083741_00229_gwi4x",
    "session": {
      "queryId": "20220802_083741_00229_gwi4x",
      "transactionId": "94c55947-831b-42f1-bf03-9409bf23a665",
      "clientTransactionSupport": true,
      "user": "presto",
      "source": "presto-jdbc",
      "catalog": "hive",
      "timeZoneKey": 1980,
      "locale": "en_US",
      "remoteUserAddress": "10.16.40.188",
      "userAgent": "Presto JDBC Driver/0.233.1-2d75403",
      "clientTags": [],
      "resourceEstimates": {},
      "startTime": 1659429461293,
      "systemProperties": {},
      "catalogProperties": {},
      "unprocessedCatalogProperties": {},
      "roles": {},
      "preparedStatements": {}
    },
    "resourceGroupId": [
      "global"
    ],
    "state": "FINISHED",
    "memoryPool": "general",
    "scheduled": true,
    "self": "http://10.16.40.182:18085/v1/query/20220802_083741_00229_gwi4x",
    "query": "SELECT  \"日期\",\"累计付费有效大众用户总数\",\"有效学习超过30分钟大众用户数\",\"有效学习大众用户占比\",\"有效学习大众用户数\",\"英语有效大众用户数\",\"语文有效大众用户数\",\"英语有效学习超过30分钟大众用户数\",\"语文有效学习超过30分钟大众用户数\" FROM (select  create_time as \"日期\"\t  ,total_effective  as \"累计付费有效大众用户总数\"  ,over_total  as \"有效学习超过30分钟大众用户数\" ,round(effective_proportion,4) as \"有效学习大众用户占比\" ,all_total as \"有效学习大众用户数\" ,en_effective as \"英语有效大众用户数\" ,cn_effective as \"语文有效大众用户数\" ,en_over_total as \"英语有效学习超过30分钟大众用户数\" ,cn_over_total as \"语文有效学习超过30分钟大众用户数\" from hive.dwm.dwm_operate_kpi_entirety where dt=date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d') and create_time <= date_format(date_add( 'day' ,-1, current_timestamp),'%Y-%m-%d') and create_time >= date_format(date_add( 'day' ,-7, current_timestamp),'%Y-%m-%d')) T GROUP BY \"日期\",\"累计付费有效大众用户总数\",\"有效学习超过30分钟大众用户数\",\"有效学习大众用户占比\",\"有效学习大众用户数\",\"英语有效大众用户数\",\"语文有效大众用户数\",\"英语有效学习超过30分钟大众用户数\",\"语文有效学习超过30分钟大众用户数\" ORDER BY \"日期\" desc ",
    "queryStats": {
      "createTime": "2022-08-02T08:37:41.294Z",
      "endTime": "2022-08-02T08:37:41.395Z",
      "queuedTime": "13.87ms",
      "elapsedTime": "101.97ms",
      "executionTime": "88.07ms",
      "totalDrivers": 149,
      "queuedDrivers": 0,
      "runningDrivers": 0,
      "completedDrivers": 149,
      "rawInputDataSize": "20.08kB",
      "rawInputPositions": 670,
      "cumulativeUserMemory": 8963316.0,
      "userMemoryReservation": "0B",
      "totalMemoryReservation": "0B",
      "peakUserMemoryReservation": "0B",
      "totalCpuTime": "23.00ms",
      "totalScheduledTime": "36.00ms",
      "fullyBlocked": true,
      "blockedReasons": [],
      "progressPercentage": 100.0
    },
    "queryType": "SELECT",
    "warnings": []
  }
]